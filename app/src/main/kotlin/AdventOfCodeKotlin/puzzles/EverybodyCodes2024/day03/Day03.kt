package year2024.day03

fun main() {
    Day03.part1()
    Day03.part2()
    Day03.part3()
}

class Day03 {
    companion object {

        fun part1() {
            val input = """
                ..............................
                ..............................
                ...........#..................
                .........###..................
                ..........########............
                ..........#########.#.........
                ........#############.........
                .........############.........
                .........###########..........
                ........#########.............
                .........#..#####.............
                ...............#..............
                ..............................
                ..............................
            """.trimIndent()
            val depths = input.lines().map { line -> line.map {  if (it == '.') 0 else 1 }.toMutableList() }.toMutableList()
            val queue = mutableListOf<Pair<Int, Int>>()
            depths.forEachIndexed { rowIndex, ints -> ints.forEachIndexed { colIndex, i ->
                 if (i == 1) queue.add(Pair(rowIndex, colIndex))
            } }

            while (queue.isNotEmpty()) {
                val (row, col) = queue.removeAt(0)
                if (row <= 0 || row >= depths.size - 1 || col <= 0 || col >= depths[0].size - 1) continue

                val neighbors = listOf(Pair(row - 1, col), Pair(row + 1, col), Pair(row, col - 1), Pair(row, col + 1))
                if (neighbors.map { depths[it.first][it.second] }.any { it < depths[row][col] }) continue

                depths[row][col] = depths[row][col] + 1
                queue.addAll(neighbors)
            }

            println(depths.sumOf { it.sum() })
        }

        fun part2() {
            val input = """
                ......................................................................
                ................................####..................................
                ............................##..#####..#..............................
                ...........................##########.#####...........................
                ...........................################...........................
                ..........................#################...........................
                ............................###############...........................
                ...........................###############............................
                .........................###################..........................
                .........................#######################......................
                ........................#####################.........................
                .......................#######################........................
                .......................#######################........................
                .......................#######################........................
                ........................#######################.......................
                ........................########################......................
                .......................#######################........................
                ......................#############..##########.......................
                ......................###########################.....................
                ......................##############################..................
                ....................#.##############################..................
                ....................###############################...................
                ....................###..###########################.#................
                .....................#..##############################................
                .......................###############################................
                ........................#############################.................
                ...........................#########################..................
                ..........................#######################.....................
                .........................######.################......................
                ........................###..#..#############.##......................
                .............................#..############..##......................
                ..................................####.#####...##.....................
                ..................................#.##.#.#............................
                ....................................##................................
                ......................................................................
            """.trimIndent()
            val depths = input.lines().map { line -> line.map {  if (it == '.') 0 else 1 }.toMutableList() }.toMutableList()
            val queue = mutableListOf<Pair<Int, Int>>()
            depths.forEachIndexed { rowIndex, ints -> ints.forEachIndexed { colIndex, i ->
                if (i == 1) queue.add(Pair(rowIndex, colIndex))
            } }

            while (queue.isNotEmpty()) {
                val (row, col) = queue.removeAt(0)
                if (row <= 0 || row >= depths.size - 1 || col <= 0 || col >= depths[0].size - 1) continue

                val neighbors = listOf(Pair(row - 1, col), Pair(row + 1, col), Pair(row, col - 1), Pair(row, col + 1))
                if (neighbors.map { depths[it.first][it.second] }.any { it < depths[row][col] }) continue

                depths[row][col] = depths[row][col] + 1
                queue.addAll(neighbors)
            }

            println(depths.sumOf { it.sum() })
        }

        fun part3() {
            val input = """
                ######################.................................................#####.................................................#################
                #.#####################................................................###.####.#............................................###############.#
                ######################...................................................#####..##........................................####################
                #####################...................................................###########.#.#...................................####################
                ######################...............................................#.#################..................................####################
                ####################............................................#....####################................................#####################
                ####################............................................####.####################...................................##################
                ####################.........................................######.####################...................................###################
                ###################.........................................###############################...............................####################
                ####################......................................##################################................................##################
                #################.........................................##################################................................##################
                #############.............................................#################################................................###################
                ############...........................................##.##############################..##..................................################
                #######.##..............................................#################################.##..................................##..############
                ##########...............................................###################################.####.............................#.....##########
                ########...............................................##########################################..................................###########
                ########...........................................#...######################################.#####.....................................######
                #####..#...........................................#.#####################################.#..#######.....................................##..
                ###.#..............................................#################################################....................................###...
                #..............................................##.#################################################......................................#....
                ...............................................###.###########################################.####...........................................
                ...............................................################################################..#............................................
                ..............................................################################################................................................
                .............................................########################......###################................................................
                ................................................####################.######.##################................................................
                ................................................###################.###..###.#################................................................
                ...............................................####################.###..###.#################................................................
                ...............................................#####################.######.##################................................................
                ....###.......................................#######################......###################................................................
                ...#####.....................................#################################################................................................
                ...#####.#..................................##################################################................................................
                ...#########.................................#################################################................................................
                #########.#...................................###############################################.................................................
                #############.................................##############################################.........................................#####....
                #############................................############################################.##.......................................#.######..#
                #############................................############################################..........................................###########
                #############.................................#############################################......................................#############
                ##############.................................##.########################################......................................##############
                ################...................................#######################################.....................................###############
                ###############...................................########################################......................................##############
                ################....................................#######################################.................................##################
                ###################................................######################################.#.................................##################
                ###################.##...............................###################################....................................##################
                ######################................................################################.#.....................................#################
                ######################..............................##################################......................................##################
                #####################...............................###########################.##..#....................................#####################
                #######################.............................###.#####.#.##############..##..#...................................######################
                #######################............................##...#####....################.......................................######################
                ######################...................................##.#......###############......................................######################
                ###################.................................................#########...........................................######################
                #.################..................................................#########..........................................#####################.#
                ###################.................................................#.######.............................................#####################
            """.trimIndent()

            val depths = input.lines().map { line -> line.map {  if (it == '.') 0 else 1 }.toMutableList() }.toMutableList()
            val queue = mutableListOf<Pair<Int, Int>>()
            depths.forEachIndexed { rowIndex, ints -> ints.forEachIndexed { colIndex, i ->
                if (i == 1) queue.add(Pair(rowIndex, colIndex))
            } }

            while (queue.isNotEmpty()) {
                val (row, col) = queue.removeAt(0)

                val neighbors = listOf(Pair(row - 1, col), Pair(row + 1, col), Pair(row, col - 1), Pair(row, col + 1),
                    Pair(row - 1, col - 1), Pair(row + 1, col - 1), Pair(row + 1, col + 1), Pair(row - 1, col + 1))
                if (neighbors.map {
                    try {
                        depths[it.first][it.second]
                    } catch (e: IndexOutOfBoundsException) {
                        0
                    }
                }.any { it < depths[row][col] }) continue

                depths[row][col] = depths[row][col] + 1
                queue.addAll(neighbors)
            }

            println(depths.sumOf { it.sum() })
        }
    }

}