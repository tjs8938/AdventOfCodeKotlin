package year2024.day14

import AdventOfCodeKotlin.util.Adjacent
import AdventOfCodeKotlin.util.Node3d
import kotlin.math.abs

fun main() {
    Day14.part1()
    Day14.part2()
    Day14.part3()
}

class Day14 {
    companion object {

        val movements = mapOf(
            'U' to Triple(1, 0, 0),
            'D' to Triple(-1, 0, 0),
            'L' to Triple(0, -1, 0),
            'R' to Triple(0, 1, 0),
            'F' to Triple(0, 0, 1),
            'B' to Triple(0, 0, -1)
        )

        fun part1() {
            val input = """
                U100,F1,U3,L1,R1,L1,R1,U2,F1,U2,F1,B1,R1,U6,B1,U1,R1,U2,R1,F2,U2,F1,B1,U1,B1,L1,U1,F1,L1,B1,U3,R1,L1,U3,L1,U1,B1,R3,B1,U2,B1,U2,R1,B1,L1,U1,R1,U1,L1,U1,R1,L1,U2,L1,R1,F1,B1,U1,F1,L1,U1,L1,D1,U1,D2,B1,D1,U3,L1,F1,R1,F2,L1,U1,D1,R1,L1,D1,R1,L1,R1,D2,R1,D1,U1,L2,F1,B1,U1,L1,B2,U2,D1,F2,U1,L1,U1,R1,D2,L1,D1,F1,U2,L1,U1,D1,U2,D5,U2,D1,U1,D1,U1,L1,D1,U1,B1,L1,B1,U1,R1,D1,U1,F1,R1,D1,L2,R1,U1,D1,F1,U2,F1,R1,F1,D1,R1,D2,L1,R1,D5
            """.trimIndent().split(",").map { it[0] to it.substring(1).toInt() }

            var current = Triple(0, 0, 0)
            val visited = mutableSetOf(current)

            input.forEach { (direction, distance) ->
                repeat(distance) {
                    current += movements[direction]!!
                    visited.add(current)
                }
            }

            println(visited.maxOf { it.first })
        }

        fun part2() {
            val input = """
                U100,B1,D1,R1,D1,L1,F2,D1,R2,D2,F2,D1,B1,D1,F1,D1,B1,D1,B1,D1,F1,D1,R1,B1,F1,D2,F2,D1,B1,R2,B1,F1,R1,D1,F1,L1,B1,F1,D1,L1,F1,L2,R1,D1,R1,B2,R1,B1,R1,L1,D1,L1,B1,R1,D1,R2,D2,L1,D2,R3,D2,U1,R1,D1,R1,F2,L1,R1,F1,B1,F1,R2,B1,R2,B1,L1,D1,B1,F1,D3,R1,F1,L1,R1,F1,R2,U1,B1,D2,F1,D1,B1,F2,L1,U1,F1,D1,R1,L1,U1,B1,D1,R1,B1,D1,B1,D1,F1,B1,F1,D1,R1,B1,D1,B1,L1,F1,R1,L1,R1,L1,F1,B1,F1,R1,U1,L1,U1,R2,B1,R1,L1,F1,L2,F1,D2,L1,R1,L3,U2,L1,B1,F1,L2,R1,F1,B2,R1,F1,R2,F1,U2,L2,R2,F1,L2,B1,L1,U1,L1,B1,F1,D1,L1,F1,B1,F1,B1,F2,U2,B3,D1,B1,F1,D1,R1,B1,D1,R1,L1,F2,R1,F1,B1,L1,F1,L1,B1,D1,B2,L1,B1,L1,B2,L1,U1,D2,B2,D1,R1,B1,L1,F1,U3,F1,U1,L3,D1,U1,R1,F2,R2,L1,F2,B1,L1,U1,R2,L1,R1,B1,F2,B1,U1,L1,U1,L1,B1,F1,U1,B2,L1,R2,B1,F1,B1,L2,F1,D1,L1,U1,R3,F1,B1,L3,R1,U1,R1,L1,B1,L1,F1,R1,L1,F1,L1,R1,B1,R2,F1,R1,U1,D1,B1,U1,B1,F2,D1,R2,U1,F1,L1,F1,L3,R1,B1,R1,F1,R2,F1,U1,L1,D1,L1,B1,U2,R1,U1,R1,F3,U1,R2,U1,R1,B1,R2,L1,B2,R1,B3,U1
                U100,R1,B1,R1,D1,R3,L1,B3,F1,B1,R1,F2,D1,R1,F1,D1,B1,D2,B1,D1,F1,L2,R1,B2,R1,L1,D1,B1,F1,B1,R1,D1,R1,D1,U1,D1,L1,D1,L1,F1,D1,R1,D1,B1,F1,B1,R1,B1,F1,R1,B1,D3,B1,D1,B1,D1,L2,D1,B1,F1,R1,L1,F1,D1,B2,L1,R1,B2,R1,B1,F1,B1,R2,L1,B1,D1,F2,D1,F1,R1,F1,L2,B2,L2,B1,L1,D1,B1,D1,B3,L1,D1,F1,D1,L2,D1,B1,F1,D1,L1,F1,L1,R1,L4,R1,L1,D1,L1,B1,F2,B1,D1,L1,R1,L1,B1,L2,D1,R2,D1,R1,D1,L1,F1,B1,D1,L1,R1,B1,D1,R1,L1,B1,D1,L2,F2,U1,F2,U1,D1,F1,B1,L1,R1,F1,D1,R1,D3,R1,U1,D1,U1,F1,L1,B1,U1,R1,B2,D1,R1,L1,U1,B1,R2,B1,L2,F1,D1,B2,U1,D1,B2,F1,B1,U1,F1,R1,F1,B1,R1,L1,U1,F1,R1,F1,D1,L2,F1,B1,F1,R1,F1,R1,F2,B1,L1,D2,R1,L1,F1,R1,F1,R1,B1,R1,B1,R3,B1,F2,L1,U1,B1,U1,D1,R3,F1,L1,R3,F1,R1,L1,B2,R1,U1,R1,U1,D1,L1,U1,D1,R1,F1,U1,R1,F1,U1,R1,F1,U2,D1,U1,B1,L1,F1,U2,D2,B4,R1,L1,B1,R1,F1,B1,L1,F1,L1,B1,F1,D1,L1,F2,L3,U1,R1,L1,U1,L1,B1,R1,U3,R2,D1,L1,D1,U1,B2,F1,B1,R1,B1,D1,L1,U3,L1,R1,L1,U1,B1,U1,D1,R1,B1,F1,U3,B1,R1,B1,R2,B1,R1,F1,R1,L1,D1,R2,B2,U1,L1
                U100,D2,R1,B1,D1,R1,L1,F1,D1,R4,L1,R1,L2,D1,L1,R1,L1,R1,B2,R1,B1,F2,R1,F1,R1,B1,F1,R1,D3,L1,B1,U1,B1,D2,B4,D1,B1,D1,L1,B1,R1,B1,L1,R1,U1,B1,F1,B1,D1,L1,B3,R4,L1,F3,B1,L1,D1,R1,L2,R2,B1,F2,B1,D2,R1,L1,B1,D1,U1,D1,F1,B1,L1,F2,D1,L1,R2,D1,L1,R2,D1,B1,D1,F1,L2,F1,B1,F1,L1,B1,L1,F2,D1,R1,F1,R1,B1,F1,L1,B1,D1,R1,B1,R1,L1,D1,F1,R1,L1,B1,R1,L1,D1,L1,F1,L1,R2,F1,D1,F1,L1,F1,D1,F1,B2,R1,B1,R1,U2,L1,B1,L2,R1,D1,F1,L1,U1,B1,F2,B2,R1,L1,R1,L1,D1,L1,R2,B1,L1,B1,R1,U1,B1,F1,U1,D1,F2,B1,F2,R1,B1,R1,F2,D1,R1,D2,B1,L1,B1,D1,U1,B1,R3,U1,D1,B1,R1,D1,U1,L1,F4,D1,F1,U1,L1,R1,B1,R1,F1,L1,B1,R2,B1,D3,L1,D1,R1,D1,L1,B1,U1,D1,B2,U1,D2,B1,D1,B1,D1,F1,U2,R1,D1,R2,D1,F1,B1,D1,B1,U1,D1,L3,D1,U1,F1,B1,R1,B2,D1,U1,B1,D1,U1,R2,B2,L1,F2,U1,B1,F1,L1,D1,R2,L1,B1,R1,D1,F1,R1,F1,R1,D1,F1,U1,R2,D1,L1,F1,R1,F2,L1,D2,B1,L1,R1,F3,R1,D1,U1,L1,F1,U1,B1,D1,F2,R1,U1,F2,L1,U1,B1,R1,U2,B1,F1,D1,B2,F1,R1,D1,R1,D1,R1,F1,L1,D1,F1,U1,R1,L1,F2,B1,L1,D1,B1,R1,B1
                U100,R1,B2,F2,D2,B1,D2,B1,D1,R2,D1,B1,R1,D1,L1,F1,D1,L2,R1,D1,B1,L1,D2,F1,R1,D2,F1,R1,F1,B1,R1,D1,F1,D1,F1,L1,B1,R1,L1,B1,L2,D1,F1,B3,F1,R1,L1,R1,L1,D1,B1,F1,B1,L1,R1,D1,F1,D1,L2,F1,R2,F2,B2,F2,B1,L2,F1,D2,L1,R1,D2,B1,R1,D1,L1,B1,L1,F1,D1,L1,D1,F2,B2,R1,D1,U1,R1,L1,B1,F1,D4,F1,B1,R1,F2,D1,R2,L1,B1,F1,D1,U1,R1,B1,L1,F1,D1,B1,L1,U1,B1,L3,U1,R1,L1,U1,D1,R2,D1,R1,F1,B1,D1,R1,L1,U1,R1,D1,F1,L2,R1,U1,B2,U1,R1,B1,R1,F1,R1,F1,B1,L1,D1,L1,R3,F1,L1,R1,F1,B1,R2,F1,R1,F2,B1,L1,U1,B1,R1,D2,R1,B1,R1,F1,R1,B2,R1,D1,F1,B3,U1,R1,B1,D1,B1,R2,B1,L1,D1,F1,B1,R1,L1,D1,R1,U1,D2,L1,D1,R1,B1,D1,F1,U1,D1,B2,F2,B1,L1,U1,L1,F2,B1,L1,R1,F3,L1,U2,F1,R2,F1,R2,L1,B1,F1,D1,B1,D1,F1,R1,F2,D1,B1,U1,B1,F1,R2,U1,F1,R1,L1,U1,R1,D1,F1,L1,D1,U1,D1,L1,R1,F1,R1,F1,D1,B1,L1,U2,F1,D1,U2,R1,F1,U1,B1,R1,U1,L1,B1,D1,R1,F1,B1,D2,R1,L1,R1,U1,L1,U1,B1,U3,D1,L1,R1,U2,L1,B1,R2,D1,F1,U1,R1,D1,R1,L1,B1,U2,B1,R1,F1,U1,R1,F1,R1,U1,R2,L1,R1,F2,U1,D2,U1,L1,B1,R1,F1,R1,L1,F1,D1,L1,R1,D1
                U100,L1,D1,L1,R2,L2,R1,D1,F1,L1,D1,R1,D2,B1,D1,R1,F1,L1,F1,D1,F2,B1,R1,D2,B1,F1,D1,R1,L1,D1,R1,U1,D1,F1,B1,L1,D1,F1,L2,D1,F1,L1,D1,L1,D1,R2,L1,R1,D2,R1,B1,F1,L1,R1,D1,F1,L1,R1,L1,F2,R2,B1,L1,R1,L1,B2,D3,R1,B1,R1,L2,F1,D2,F1,D2,F1,D1,R1,B1,R1,F1,B1,R1,D1,L1,R2,L2,D1,L3,R1,D1,L1,B3,R1,B1,U1,B2,U3,B1,D1,U1,R1,B2,L2,B2,D4,F1,L1,U1,B1,R1,L1,D2,L1,B1,L2,F1,B1,F2,D1,F2,D2,U2,B1,F1,U1,F2,R1,U1,D1,B1,L1,D2,R1,L1,B2,F1,D1,L1,B1,U1,F1,B1,L1,D1,B1,R1,B1,R1,L2,D1,B2,L1,B1,F2,D1,B2,L1,R2,F1,B1,L1,B1,L2,U1,F2,R1,L1,F1,D1,B1,R1,D1,B1,L1,R1,L1,D2,U2,F1,B1,L1,B1,F3,B1,R1,B1,F1,L1,D1,U1,D1,R1,D1,L1,D1,U1,R1,L1,B1,D1,F1,B1,U1,D1,U1,B1,F1,B1,L4,B1,L2,U1,D1,U1,R1,U1,B1,R1,L1,U2,R2,B1,L1,D1,B1,U1,L1,U1,L1,D1,B1,L1,R1,B1,R1,L1,B1,R1,F1,U1,R1,L1,D2,F1,U2,B1,R1,U1,R2,F1,U1,B1,F1,U2,F1,L1,R1,B1,U1,R1,D1,L1,D1,L2,B1,R1,F1,U1,R1,D1,B1,U1,L1,B1,L1,B1,L1,U1,B1,R1,D1,B1,D1,F1,B1,L2,U1,R1,L2,R2,U1,R2,U2,B1,L1,U2,B1,F1,B1,R1,B2,R1,B2,R1,L1
                U100,R1,B1,D1,R1,L1,F1,B1,D1,B1,D2,F2,D1,L1,D1,F1,R1,B1,D1,B1,F1,R2,L1,D1,B1,R1,L1,F1,D1,B1,L1,B2,D2,F1,R1,B1,L1,D2,R3,D2,R1,B1,D1,B1,F2,D1,B2,F1,L1,D1,F2,R1,L1,F1,D2,R1,L1,B3,D1,R1,F1,R1,D1,R2,L1,B1,D1,F3,D1,B1,R1,L1,B1,F1,R1,B1,R1,F1,L1,B1,D2,L1,B4,R1,F1,D1,R1,D1,F2,D1,R1,F1,R1,F1,D1,L1,D1,F1,R1,F2,L2,B1,R1,D1,R1,F1,B1,R1,U1,R1,F1,B1,R1,F1,R1,L1,R1,F1,L1,U1,B1,F1,L1,U1,L1,D1,U1,L1,F1,B2,L1,U1,R1,F1,L1,F1,R2,L1,F1,D1,R1,F1,B1,R2,F1,L4,B2,R1,D1,F1,L2,R1,B1,R1,F1,U1,D1,U1,B1,D1,U1,R1,B1,D1,R2,F1,R1,L2,F1,L1,U1,F2,R1,L1,U1,F1,D1,L1,F1,B1,U1,D1,B1,D1,F1,B1,R2,B1,R1,B1,D1,B1,D1,L1,D1,U1,F1,D1,B1,U1,B1,F2,R1,L1,F1,R1,L1,D1,L2,F1,L1,B2,D1,B1,F1,U1,D1,F2,U1,R1,L2,F1,L1,R2,L1,R1,B1,F1,R1,L1,R1,B1,R1,U2,L1,B1,L1,R1,B1,D1,L1,R1,B1,D1,B1,L1,R2,F2,R1,F1,L1,U1,F1,R1,B1,U1,L1,B1,L1,B2,U1,R2,U2,R3,U1,D1,L1,R2,D1,L1,R1,D1,B1,F1,L1,B1,L1,F1,B1,L1,U1,L2,U1,R1,L2,R1,L1,F1,L1,F1,D1,B2,L1,F1,L1,R1,U1,D1,R1,D2,U2,R1,U2,R2,L1,D1,R2,U1,R1,F2,R1,D1,R1,B2
                U100,L1,F3,R1,L1,B1,F2,R1,F1,B1,L1,D1,L1,F1,D1,L2,R1,B2,L1,R1,F1,R1,D1,B1,L1,D1,L1,R1,L2,R1,B1,L1,R1,L1,B1,D2,L2,B1,L2,D1,F1,D1,B2,F2,R1,B1,F1,L1,R1,D1,F1,R1,D1,R1,L1,R1,L1,B1,L2,F1,L2,R1,L1,D1,F1,B1,D1,R1,L1,U1,L1,D1,L1,B1,F2,D1,L1,D1,R1,L2,B1,R1,L1,F1,D2,U1,D1,R1,F1,B1,D1,L1,F1,R2,D2,R1,L1,B1,L1,D1,L1,R1,L1,D1,B1,D1,U1,B2,L1,B1,R1,F1,R1,F1,B1,R2,F1,L1,D2,L1,D1,U1,D2,R1,L1,R1,D1,R1,F1,B1,L3,F1,R1,F1,L3,B1,L1,U2,F2,U1,B1,D1,R1,D1,B1,D1,L1,U1,B1,R1,D1,L2,U1,R1,D1,L1,R1,B1,F1,B1,L1,F1,B1,R2,B1,D1,B1,F1,R2,L1,B1,F2,R1,D1,F2,L1,D1,L1,R1,L1,B1,R1,F1,R1,U1,L1,U1,L1,R2,F1,B1,U1,F1,B1,L1,U1,D1,L1,B1,U1,D2,B1,L1,B2,R2,D1,B1,R1,D1,F1,R1,U1,B1,U2,L1,B1,R1,B1,F1,R1,D1,U1,R1,F1,B1,R1,D1,R2,F2,D1,L1,F1,B1,L3,B1,R1,B1,D1,U1,B1,D1,L1,B1,R1,B2,R2,F1,B1,R1,F1,D1,L2,D1,U1,F1,R1,D1,B1,U1,L1,U1,R1,D1,F1,L1,U1,B1,L1,U1,L1,U1,B2,R1,U1,L1,D1,F1,B1,F1,B1,R1,B1,R1,B1,U1,F1,B1,R1,B1,D1,R1,F1,U1,F1,L1,R1,L2,R1,B1,L2,F1,L1,F1,R2,L1,F1,L1,B2,F2,R1,U2,R1,D1,U1,D1,B1,F1,R2,U1,L1,U1,R1,B1
                U100,D2,F1,R1,L1,B1,D1,F1,B1,L1,F1,R2,F1,D2,B1,L1,R1,D1,R1,B1,F1,L1,D1,F3,D2,F1,R1,F1,B1,D1,L1,F1,R1,B1,L1,D2,F1,L1,D2,L1,B1,D1,L1,D2,B2,D1,R2,D1,B2,D1,U1,R1,F1,L1,R1,L2,D3,L1,F1,R1,F3,D1,R3,B1,R1,L1,U1,B1,F2,R2,B1,D2,R1,F1,B2,D1,R2,U1,L1,B1,D1,F1,D2,F1,D3,L2,D1,F1,L3,D2,L3,F1,D3,L1,D1,L1,F1,D1,R2,D2,R1,D1,B1,R1,F1,B1,R1,D1,R1,F1,L1,F1,B1,U1,R2,B3,U1,L1,R1,B1,D1,R2,U1,F1,D2,L1,D2,U1,B2,F1,U1,L1,D1,L2,R1,L1,R1,F1,D1,B1,R1,F1,L3,U1,L1,F1,U1,F1,D1,B1,R1,B1,R1,D1,U1,B2,D1,L1,D2,L1,U1,B2,F1,R1,U1,R1,L1,B2,F2,D1,F1,R1,B1,L1,F1,L1,B1,D1,F1,U1,F2,R1,F2,B1,L1,R1,U1,L2,R1,L1,F3,B1,F2,R1,D1,F1,D1,R1,B1,F3,R1,L1,F1,D1,B1,R1,F1,D1,F1,U1,F1,U1,R1,B1,F1,R1,L1,D1,L1,B1,U1,R1,F1,R1,F1,L1,R1,U1,B1,R1,L1,U1,B1,L1,D1,L1,R1,L2,D1,F1,R1,F1,B1,U3,B1,D1,L1,R1,D1,B1,L1,D1,U1,D1,B1,F1,D1,R2,D2,L2,U1,R1,B2,F1,D1,U1,L3,F2,U1,F1,D2,B1,D1,F1,D1,R1,L3,B1,U1,R1,F1,R3,L1,B1,R1,F1,B1,F2,R1,F1,B1,R1,F1,R1,D1,F1,U3,B1
                U100,L1,D1,L1,D1,R1,D1,R4,B1,D1,B1,L1,B1,F1,D1,L1,B2,L1,R2,D2,L1,D1,F2,L2,B1,F1,D1,L1,B1,L2,B2,F1,R1,F1,R2,L1,B1,F1,R1,L2,F1,D1,F1,R1,L1,D1,F2,D1,B2,L1,D1,B1,R3,B1,D1,L1,D1,B1,L1,R1,D1,F1,D1,F2,R1,L2,F1,L1,R1,D2,F1,U1,F1,R2,L1,R1,D2,R2,F1,L1,D1,F1,B1,D1,F1,R1,B2,D1,L1,B1,F1,R1,L2,B1,U1,L1,D1,R1,U1,D2,B2,D1,L1,R2,B1,U1,D1,R1,L1,D1,L2,R1,B4,R2,D1,L1,F2,B1,R2,D2,F1,R1,B1,U1,R1,D1,R1,F1,R2,D1,B1,F1,B2,U1,L1,D2,F1,R1,L1,D1,B1,F1,R3,U1,F1,L1,R4,F1,D1,U2,F1,R1,D1,U1,F1,L1,B1,D1,B1,F1,L1,F1,B1,L1,R1,F1,R2,B1,R1,U1,B3,F2,U1,B1,F1,R1,B2,F1,D1,B2,R1,F1,D1,F2,U1,B1,L1,B1,F1,B1,R1,D1,F1,U1,R1,D1,F2,D1,F1,L1,R2,L1,F2,L1,B2,R3,U1,D1,U1,D1,R2,D1,U1,R1,F1,B1,L1,D1,U1,D1,F1,R1,F1,B1,U2,R2,F1,U1,B1,L1,D1,F1,B1,F1,D1,F1,R1,B1,F1,D1,R1,F1,U1,L1,B1,R1,U1,B1,L1,B1,F1,B4,L1,F1,B1,D1,B1,F2,R1,F1,B1,F2,R1,F1,R1,B1,R1,B1,F1,B1,L1,R1,B1,F1,B1,R1,U3,B1,R1,U1,L1,F1,L1,U1,D1,R1,B2,F1,B1,U2,R2,L1,F2,B1,F1,R1,L1,D1,F1,U1,B1,F1,R1,L1,U1
                U100,F1,D1,R1,D1,R1,F2,L1,D5,F1,L1,B1,F1,R1,D1,B1,D1,B1,L2,R1,D1,L1,R2,L1,F1,R2,F1,D1,F1,L1,B2,U1,R1,D1,L1,F1,B1,L1,R1,F1,R1,F2,L1,F1,D3,B1,R2,F1,D1,R1,L1,B1,D1,R1,F1,D1,F1,B3,F2,B2,F1,B1,F1,D1,L1,R1,L1,R1,F1,L1,R1,B2,L1,F1,U1,D1,F1,B1,L2,B1,F1,D1,B1,L2,D1,B1,D1,U1,R1,U1,D2,L2,R1,D1,R2,D1,L1,B1,D1,L1,U1,R1,B1,F1,B1,F1,R2,D1,B3,L1,D1,R1,F2,B2,F1,L1,D2,L1,D1,B1,F1,R1,F1,R1,F2,L1,R1,U1,R1,F1,D1,B1,D1,B2,D1,L2,B1,R1,B2,L1,F1,D2,F2,R1,B1,R1,F1,L2,F1,B1,R1,B2,L1,B1,R1,B1,L1,R1,F1,B1,U1,F1,L2,R1,B1,L1,U1,L1,B2,L1,F1,B1,F1,R1,B2,D1,L1,B1,D1,B2,R1,L1,F2,R3,B1,U2,R1,D1,R1,B1,L1,F1,B1,F1,R2,B1,L1,F1,B1,L1,U1,R2,L1,F1,D1,R1,B2,U1,L1,F1,R1,B2,D1,B1,L2,F1,B1,U1,R1,U1,L1,B1,L1,D2,F1,R1,D1,B1,R1,U1,F1,L2,B1,L1,B1,L1,R1,F1,D1,F1,R1,L1,B1,L1,F1,L2,B1,L1,R2,F2,L1,F1,L1,B2,L1,U1,R1,B1,L1,R1,B1,U2,L1,R2,B1,R1,L1,B1,D1,B1,F1,U1,L1,F1,U1,L2,B1,F1,L1,B1,R1,L2,D1,L2,F1,B1,L1,B1,L1,R1,F2,D1,L1,D1,R1,F1,U1,L1,R1,L1,U2,L1,U1,L1,U1,R1,F1,U2,F1,R1,U1,R1
                U100,D2,R1,F1,R1,L1,D1,L1,F1,L2,R1,D2,B1,L2,B1,F2,R1,F1,B1,D2,F4,L1,F1,B1,D1,U1,L2,F1,R2,F1,U1,F2,B1,D2,F2,R2,L1,D3,B1,D1,F1,R1,B1,D2,B1,L1,D1,F1,R1,L1,R1,B1,F2,L1,F2,U1,R2,L1,D1,B2,R1,L1,U1,L1,F1,L1,D1,R1,F1,B1,D1,B1,R1,L1,D1,R2,D1,U1,F2,L2,F2,L1,D1,U1,D2,L1,B2,R2,L1,D1,F1,R1,F2,D1,B1,F3,B2,D1,U1,R1,B1,D1,L1,B1,R1,F1,B1,L2,B1,D1,R1,F1,L1,F1,U1,R1,D1,R2,F1,D1,F1,U1,D1,F1,D2,F1,R2,L1,R2,F1,U1,L2,U1,F1,L1,F1,L1,D1,F1,B1,F1,L1,U1,B1,D1,R1,B1,R1,L1,R1,F2,L1,U1,F1,R1,D2,R3,U1,D1,B2,U1,L1,B1,D1,B1,D1,B1,F1,B1,R1,D2,B1,F1,D1,L1,B1,L1,D2,F1,U1,F1,L1,R1,D1,L1,B2,D1,R1,U1,F1,L1,R1,F1,R2,F1,B3,F2,B1,R1,B1,U1,L1,D1,R1,B1,U1,R2,L2,D1,F2,U1,B1,F1,L1,F1,B1,R2,D2,L1,B1,F1,B1,L1,B1,D1,U1,D1,F1,B1,F1,D1,B1,L2,U2,L1,D1,L1,B1,L2,R1,F1,D1,L1,U1,B1,L1,D1,F1,U1,F1,R2,L1,B1,U1,F1,B1,F2,B1,D1,R1,F1,B1,U2,F1,B2,U1,B2,L2,U1,B2,F1,R2,U1,L1,R1,D1,F3,L1,R1,B1,U1,D1,R2,F1,B1,D1,R1,F1,U1,L1,R1,B1,F1,B1,L1,B1,L1,B1,F1,L1,R2,D1,U1,B2
                U100,R1,L2,D1,F1,B1,D1,L2,B2,R1,L3,D1,L1,D1,F1,B1,L1,F1,B1,F1,U1,R1,L1,D2,R1,F2,B1,R5,D1,L1,B1,F1,R1,F1,D1,B1,D2,L2,R1,D3,R1,L1,D1,B2,F1,R2,B1,R1,B1,F1,B1,D2,L1,D1,B1,D3,R1,D1,R1,L2,R1,L1,R1,B1,D1,R1,B1,F1,L1,R1,L1,D1,B1,L1,B2,L2,U1,F1,R1,L1,R1,D1,R1,B1,D1,F1,B1,L2,F2,D1,R1,F1,R1,B1,F1,D1,B2,F1,D1,B1,F1,B1,F1,B1,R1,D2,L1,D1,L1,F1,R1,D1,L4,R1,D2,F1,D2,F1,R1,L1,D1,F2,U1,F1,L1,F1,L1,F1,U1,L1,F2,L1,B1,L2,F1,L1,R1,D1,B1,D1,R1,U1,L1,R1,B1,F1,B1,F2,R1,B1,L1,B2,U1,R2,D1,R1,L1,R1,F1,B3,R1,L2,D1,B1,L2,B1,F1,R1,L1,F2,B1,L1,B2,R1,U1,R1,D1,L2,F1,R1,D1,F1,L1,R1,F1,U1,B1,L1,D1,B1,L1,R1,L1,B2,U1,F1,B1,U2,R1,D1,B1,R1,B1,D1,U1,R1,L1,D1,B1,R2,F1,R2,U2,R1,F1,U1,L1,R1,B2,F1,B1,F1,L2,U1,B1,F1,R1,F1,U1,B1,R1,D1,U1,R1,F1,B1,L1,B1,U1,R1,F2,U2,R1,B1,U1,L1,B1,F1,L2,R1,D1,R1,L2,F2,D1,B2,U1,R1,B1,R1,D1,B1,F1,U1,L1,R2,D1,R1,B3,L1,B1,R1,U1,R1,D1,F1,U1,F1,L1,R2,U1,R1,F1,R1,L2,R1,L1,B2,D1,U1,B1,R1,B1,F1,U1,F2,L1,B1,L1,B2,L1,R1,B1,L1,U2,D1,R1,F2
                U100,F1,D1,R2,L1,B1,L1,D2,R1,F1,B1,D1,L1,R2,D1,L1,D1,R1,F1,R1,F2,R2,B2,F2,D1,B3,R1,F1,R1,L1,D1,B1,L1,D3,L1,D2,F1,L1,D1,L3,R1,B4,F1,R4,F1,L1,R1,D2,F1,B2,F1,R1,F1,R2,L1,R1,B1,F2,B1,F2,D2,F1,B1,D2,L1,D1,F1,U1,D1,B1,F1,R1,F1,B1,D1,L1,D1,R1,F1,R1,F1,R1,B1,F2,U1,L1,F1,D1,R1,D1,F2,R1,B2,L1,B1,U1,D1,F1,L1,F1,R1,D1,L1,D2,U1,D1,B1,R2,L1,U1,D2,B1,D1,L1,D1,U1,F1,B1,R1,L2,R1,U1,R1,D2,B1,L1,F1,L1,B1,U1,L1,D1,U1,R1,D1,F1,R1,B1,F1,U1,F1,U1,B1,L1,F1,L2,R1,U1,R1,B1,L1,F1,B1,L1,U1,F1,L1,B1,D3,F2,L1,R2,L1,F4,R1,U1,D1,R1,F1,L1,B1,D2,F1,R1,U2,R1,B1,F1,U1,D1,F1,L1,R1,F1,B1,F1,U1,R1,U1,B1,F1,U1,L1,D1,L1,R1,L1,B1,D1,B2,F1,R1,L1,F2,D2,R1,U1,B1,D1,B1,L1,F1,U1,B1,L1,F1,L1,D1,R1,B1,L1,B1,F2,R1,D1,L1,D1,F1,L1,U2,L1,B2,U1,B1,F2,R1,L1,F1,B1,F1,R1,U1,R1,U1,L2,B2,U1,D2,B1,L1,B1,F1,L2,F1,D3,B1,R1,U2,L1,B1,F2,R1,F1,U2,B1,F1,L1,R1,F1,B1,L1,U1,B1,U1,B1,R1,B2,L1,F1,R1,B1,L1,D2,F1,U1,B1,D1,U1,L1,R1,B1,L1,B1,L1,B1,D1,F1,L1,R1,U1,D1,U1,F1,B1,F1,R1,B1,U1,L1,R2,L1,R1
                U100,F1,R1,F1,B1,D1,B1,F2,D2,F1,R1,D2,L2,D1,F1,R1,B1,L1,B1,L1,R1,B1,L1,D1,B2,D1,B1,R1,L2,R1,L1,F1,L1,D5,F1,R1,L1,F1,B1,L1,R1,D1,F1,L1,U1,L1,B2,F1,D1,B1,D2,F3,L2,F1,B2,R1,L1,F1,D1,L2,R1,L1,F2,R2,D1,U1,D1,B1,F1,R1,B1,F1,R1,D1,R1,L1,F2,L3,D1,L1,R1,F1,L2,D1,R1,L1,D1,R1,U1,B1,F1,R1,L2,R1,F1,D1,F1,D1,B1,L1,F1,L1,U1,B1,L1,D1,R1,L1,B1,L1,B1,R1,D1,R1,B2,D2,F2,D2,F1,R1,F1,B1,R1,D2,B1,L1,U1,D1,F1,R1,L1,D1,B1,F1,B1,F1,L1,D1,L1,B1,D1,U1,L1,B2,F2,L1,F1,D1,B1,U2,B1,L2,B1,R1,B1,R2,B2,R1,B1,R2,B1,L1,F1,R1,L1,B1,R1,B1,F1,L1,B2,L1,R1,L1,R1,F1,B1,F1,D1,U1,L1,R1,L1,U1,R3,D1,R1,L1,U1,D2,F1,U1,L1,F1,B1,R2,L1,F1,R1,D1,L1,D1,U1,R1,D2,F1,B1,F1,R1,B2,F2,U1,L1,F1,L1,D1,B2,L1,F1,B1,D1,L1,F1,B1,R2,B1,R1,L1,F2,L2,F1,R1,L1,B1,F1,B1,R1,B1,L1,B1,F1,R1,D1,U1,R2,L1,R1,F1,R1,L1,U1,R1,F1,R2,U1,L1,D1,B1,D2,R2,U1,F2,L1,F1,L1,R1,F4,U1,L1,F1,L1,B1,L1,R2,L3,B1,D1,L2,R1,F4,D1,U2,B1,L1,R1,U1,B1,R1,B1,R1,F1,U1,L1,B1,U1,L3,U2,F1,U2,F2,B1,R1,L1,U1,F1,U2
                U100,D1,B1,F1,B1,L1,D1,R3,F1,D2,R1,B1,R1,F1,D1,L1,B2,L1,D1,B1,L1,B1,F2,L1,B2,D1,R2,D1,F1,L1,B2,D1,L2,D1,L2,D1,L2,R1,F1,B1,D1,B2,F2,L1,R1,B2,D1,F1,R1,B4,D1,F1,L1,D1,F1,D1,L2,D1,R1,L2,F1,D1,B1,R1,D1,R1,L2,B1,F1,L1,U1,B1,L2,B1,F1,B1,F2,D1,F1,R2,D1,B1,L1,F1,D1,R1,L2,F1,D2,R1,U1,D1,R1,U1,B1,R2,F1,L1,B1,R1,D1,F2,R1,U1,R2,F2,B1,R1,L1,D1,L1,D1,R1,D1,R1,F1,D1,U1,L1,D1,B2,R1,U1,D2,R1,F1,B3,D1,U1,R1,D1,R1,F1,L1,D1,L1,F1,D1,B1,L1,F1,U1,L1,D1,F2,R1,F1,L1,B1,F1,R1,L1,R2,B1,R1,F3,B2,L1,D1,L2,D3,F1,L1,F1,L1,D1,F1,L1,U1,D1,B1,D1,L1,B2,U1,B2,L1,F1,D1,B1,F1,B1,L1,F1,D1,B1,D3,R1,B1,F1,L1,R1,B2,F2,U1,L1,R1,U2,R4,L1,R1,B2,L1,B1,U1,L1,B1,U2,F2,D1,R1,L1,R1,B1,R1,U1,F3,D1,U1,L1,B1,U1,R2,B1,R1,L1,B3,U2,L3,D2,L1,B1,R1,F2,U1,L1,U1,L1,U2,B1,F1,R1,B1,R1,U1,B1,U2,F1,R2,B1,U1,B1,D1,U3,B1,U1,L1,R1,U1,R1,L3,U1,R1,U1,B3,L2,B1,D1,R1,D1,U1,F1,L1,F1,R1,B1,D1,U1,F1,D1,B1,R1,B1,F1,L1,F2,L1,B1,L1,D1,U1,B1,F1,L1,D1,U1,B2,D1,B1,L1
                U100,D1,L1,R1,B1,R1,D1,R1,B3,D1,F1,D1,B1,D1,R1,D1,F1,R1,L1,R1,D2,L1,D1,R1,L1,B1,L1,D2,B1,F1,R2,L1,R1,U1,R1,D1,F1,R1,U1,D1,R1,B1,R1,F2,D2,L1,D1,B1,R1,D2,B1,U1,R1,B1,R1,D1,R2,B1,D1,R1,F1,B1,D1,B1,D2,L1,R2,L1,R1,L1,R1,L1,D1,B1,L1,F1,L1,R2,D2,L2,U1,R3,F1,B1,R2,B1,F2,B1,R1,F1,R1,B3,F1,U1,F1,R1,D1,U1,B1,D1,F1,B1,D1,U1,B2,L1,U1,R2,B2,F1,L1,B1,F1,B1,D1,L1,R1,L1,R1,F1,L1,D1,B1,L1,R1,D1,L2,D1,F1,B1,D1,L1,F1,B1,F1,R1,B1,L1,R1,F1,L1,R1,F1,U1,D1,F2,B2,U1,F2,D1,R1,F1,B1,L2,B2,F1,L1,R1,F3,R1,L1,F1,B1,F1,L1,B1,D1,U1,R1,D1,L1,R2,U1,B1,L1,D1,U1,R1,F1,R1,U1,L1,R1,B1,D1,L1,U1,D1,L2,R1,D1,B1,R1,U1,D1,F1,R1,L2,B1,U1,L1,B1,U1,F2,D1,R2,D1,U2,L1,D1,L1,F2,B3,L1,B1,R1,B1,F1,L2,R1,L3,R2,B1,U1,B1,R1,D1,U1,L1,D1,R1,B1,L1,R1,F1,R1,L1,B2,D2,F1,B2,U1,F1,B1,L1,F2,D1,B2,R1,F1,D1,L1,R1,F1,B1,U1,B1,U1,R3,D1,R1,B1,F1,U1,F1,U3,R1,U1,F1,D1,R2,F1,L1,R1,U1,F1,B1,U1,R1,B2,R1,F1,U1,F1,R1,B1,L1,R3,F1,U2,B1,F1,U1,R1,U1,L1,R2,L1,B2,F1,R1,D1,F2,R1,D1,B2,D1,R2,F1,B1,L1,F1,B1
                U100,R1,F1,R1,B1,R1,L1,R1,B1,D1,L1,F1,R1,D1,F1,D1,B1,R1,L2,D1,L2,B1,F1,L1,B1,D1,B2,L2,F1,D2,B1,F1,D1,B2,D1,R2,L1,D2,B2,D1,R1,U1,F1,R1,L1,F1,D1,B1,R1,L1,B3,D1,B1,R1,B1,F1,L1,R1,B1,L1,U1,F1,L1,F2,L1,D1,F1,D2,F1,L1,R1,F1,L1,R1,D1,B2,L1,R1,D1,L1,R1,L1,F1,L1,R1,D1,R1,D1,B1,L3,R1,U1,B1,R1,F1,D2,R2,D1,U1,L2,F1,D1,L1,F2,L1,B1,F1,B1,D1,F1,L1,F1,R1,L1,B1,D1,B1,F1,B1,L1,F1,L1,R1,L1,U1,D1,R1,D1,R2,D1,F1,B1,F1,R1,B1,R3,D2,B1,U1,L1,F1,D1,R1,L2,B1,F1,R1,L1,B1,L1,B1,L1,D1,F1,R1,B1,D1,R2,L3,D2,R1,F1,B1,L1,B1,F1,D2,F1,U1,B2,F1,B2,U1,B1,F1,D1,L2,R1,U1,L2,F1,U1,L1,B1,R1,U1,L1,F1,L1,B1,R1,L1,F2,U1,B1,R1,F1,R1,F1,R1,U2,F1,D1,B1,F1,L2,B1,L1,F1,B2,U1,L2,F1,B1,R1,L1,B3,L2,D1,B2,D1,L1,F1,L1,R1,D1,L1,B1,D1,R1,B1,L1,B1,L1,D1,B1,F2,U1,R1,D1,U1,L2,F1,L1,B1,U1,L1,R1,D1,U1,B1,R1,L2,F1,D1,U1,R1,B1,L2,D1,B2,U1,B1,F1,L2,B2,U1,R1,L1,D1,R1,B1,L1,U2,B2,U2,D1,L1,B2,L1,D1,B1,U1,R1,B2,R2,L1,F1,R1,L1,B1,F1,B1,L2,F1,U1,R2,L1,R1,F1,L1,R1,B1,L2,U1,F1,R1,F1,U1,L1,R1,D1,L1,F1,U1,R1,B1
                U100,L1,R1,D1,F2,L1,D2,R2,D1,R2,F1,B1,L1,U1,B1,D1,L1,D1,B1,D1,L2,D1,R1,D1,F1,D1,L1,D1,B1,D1,L1,R2,D1,L1,B1,L2,R2,F1,D1,B1,L1,D1,F1,L1,D2,L2,B1,D1,B1,F1,L1,F1,R1,D2,F1,L1,F1,D1,B1,F1,D1,B1,F2,R1,L1,R1,D1,B1,F1,D1,L1,D1,L1,B1,L1,R1,F1,R1,U1,F1,L1,B1,F2,D2,B1,R1,L2,D1,R1,B3,R1,L1,D1,L1,B1,F1,D1,U1,L2,U1,B2,U1,R1,F2,R1,D1,U1,R1,D1,U1,F1,U1,F1,R2,B1,D1,L1,B1,U1,D1,B1,D1,F1,B1,L1,B1,D2,B1,F2,B1,F1,B1,L1,F1,R1,B1,F1,U1,F1,D1,B1,D1,F2,R1,B1,F1,U1,R1,B1,U1,R1,F1,L1,U1,B1,L1,R1,F1,L2,F2,L1,F1,B1,L2,D1,L1,D1,U1,B1,L1,F1,R1,B1,R1,U1,B1,F1,B2,R1,F1,B1,R1,U1,L1,F1,R1,B1,L1,R1,L1,B1,L1,B2,R2,F1,R1,L1,F1,L1,U1,F1,R1,B1,R1,L1,F2,L1,D1,F1,L1,U1,L2,D1,R1,D1,U1,L1,D1,F1,R1,D1,B1,R1,B1,F2,B1,D2,U1,F2,R1,U1,D1,R1,B1,R1,D1,F1,R1,D1,F2,L1,B1,R1,D1,B1,L1,B1,L1,R1,D1,B1,D1,B1,U1,B2,R1,D2,L1,U1,B1,R1,U1,B1,L1,B1,U1,R1,U1,L2,R1,L1,B1,D1,L1,F1,D1,B1,F2,U1,L1,D1,L1,B3,F1,B1,U1,B1,F1,U2,B1,R2,F1,L1,D1,L1,B1,F1,B1,R1,D1,B1,F1,U1,D1,R1,B1,R1,B1,R1,L1,U1,F4,R1,U1,R1,B1,F1,U1,L1,B1,F1,B1,L1,B1,L1,R1,B1,R1,D1
                U100,F1,D1,L2,F1,L1,R1,F1,L1,B1,D1,F1,R2,L1,D1,F2,R1,L1,R1,L1,F1,D1,F1,D1,L1,B1,D3,F2,L1,D2,L1,D2,F1,D1,L1,R1,D2,R2,D1,L1,D1,L1,B1,L1,R1,D1,B1,F1,D1,F1,B1,F2,R1,L1,F1,R1,D1,B1,F3,L2,F1,B2,F1,D1,R1,D1,F1,D2,R1,D1,L3,F1,R2,D1,B1,U1,B1,D4,L1,F1,B1,R1,D2,F1,L3,U1,R1,U1,L1,F1,L1,F1,D1,B1,R1,B1,D1,B2,F2,L1,D1,L1,D1,F1,R1,F2,D1,B3,F1,R4,D1,L1,B2,R1,B1,L1,F1,L1,D2,R1,L1,R1,B1,D2,U1,L1,F1,B1,D1,L1,R1,F1,B1,R1,B1,R3,B4,R2,F1,B2,R1,D1,R3,F2,L1,R1,F1,B1,D2,L1,R1,B1,F1,D1,L1,B1,F1,D1,L2,F2,B1,U1,D1,R1,B1,D1,F1,D2,B2,R1,L1,B1,R2,U1,R1,B2,L2,R1,F1,B1,R1,U1,D2,L1,B1,L1,F1,R1,U1,D2,F1,B1,F1,D1,B1,L1,F1,B3,F1,D1,F1,R1,U1,L2,B1,R1,U1,F2,B1,D1,U1,B1,F2,L1,U1,B1,U1,R1,D2,L1,D1,B1,L1,D1,U1,F1,L1,F2,R1,L1,U1,B1,R1,B1,R1,L1,B1,D1,B1,D1,R1,U1,F1,B2,L1,F1,R2,F1,B1,R1,U1,R1,F1,R1,U1,B1,R1,D1,R1,U1,D1,U1,B1,L2,U1,D1,F1,R1,U1,R2,B2,U1,D1,B1,L1,U1,F2,L1,B1,L1,U1,F2,U1,B1,F1,B1,L3,B2,U1,B2,L2,D1,B1,L1,B1,U1,L1,F1,D1,F1,B1
                U100,R2,D1,B1,D1,B1,F2,R1,F1,D1,F1,D2,F2,D1,F3,R1,D1,L1,D1,R1,F1,L1,D1,B1,F1,L1,D1,F1,B1,R2,F1,L1,D1,L1,D1,F1,B2,R1,D1,B1,D1,L1,F1,D1,F1,D1,R1,B1,F1,D1,U1,D1,F1,D2,B1,D1,F3,R2,L1,F2,D1,L1,R1,D1,U1,L1,B1,D1,L1,R1,F5,R1,F1,L3,D1,B1,F1,L1,F1,L1,D1,R1,F1,L2,B1,D1,F1,D1,R1,U1,D1,R1,D1,F2,L2,U1,D2,F1,B1,D1,B1,R1,B1,L1,R2,U1,B2,D1,F1,D1,R1,L1,F1,B2,F1,R1,F1,U1,B4,F1,L1,B1,F1,D1,L1,F1,D1,R1,F1,B2,F2,D2,L3,B3,F1,D1,U1,R3,L1,D1,F2,B1,D1,F1,R1,B2,R1,B1,R1,L1,U1,D1,R1,D1,L1,D2,R2,F1,B1,L3,F1,D1,R1,L1,B1,F1,L3,B1,F2,D1,F1,B2,L1,R2,L2,B1,D1,R1,D2,L2,D2,F2,B2,F1,B1,L1,U1,B2,D1,U1,F1,B1,R1,L1,R1,F1,L2,F1,B1,D1,F1,R1,D1,B1,L1,R1,U1,L1,D1,L1,D1,F1,R1,B1,L1,B1,F1,R1,B1,F2,R1,B2,F1,B2,L1,F1,R1,U1,L1,R1,U1,F1,B1,F1,L1,B1,L1,D1,B1,R1,F1,L1,B2,L1,D1,L1,D1,L2,D1,B1,F1,R1,U1,B1,R1,F1,R1,U1,R1,B1,R1,F1,L1,B1,F3,D1,U1,R1,U1,B1,F1,B1,R1,D1,R1,F1,L1,R1,B1,R1,B1,F2,D1,F1,U2,R1,L3,F3,L1,U1,B1,R1,U1,L2,R1,B1,L2,R1,D1,F1,U1,F2,U1
            """.trimIndent().split("\n").map { it.split(",").map { it[0] to it.substring(1).toInt() } }

            val visited = mutableSetOf<Triple<Int, Int, Int>>()

            input.forEach { branch ->
                var current = Triple(0, 0, 0)

                branch.forEach { (direction, distance) ->
                    repeat(distance) {
                        current += movements[direction]!!
                        visited.add(current)
                    }
                }
            }
            println(visited.size)
        }

        fun part3() {
            val input = """
                U86,L1,F1,R1,U1,B1,F1,R2,F1,R1,B1,R4,B1,U1,B4,F2,L1,R1,B2,D1,R1,F1,L1,B1,U1,F3,R1,L1,F1,R1,F1,B1,L1,B1,F1,B1,F1,B1,F1,L1,B1,R2,F2,R1,B1,L2,U2,B3,L1,B1,F1,R1,L1,F2,R1,F1,U1,L1,F1,R1,U1,F2,L1,B1,L1,B2,L3,B1,R2,B1,F1,B1,F2,B1,R1,B2,L1,F1,L1,B2,F1,R1,F1,R1,F1,B2,R2,L1,F1,B1,R1,U1,R1,F1,R1,L2,F1,R2,B1,L1,R1,B1,R1,F1,L3,B1,L2,B1,L2,U1,F1,L1,F2,U1,F1,L1,R2,L1,B1,L3,F1,R2,F1,R2,L1,B1,R2,L1,F2,B1,R1,U1,R1,L1,B1,R1,F2,L1,B1,L1,U1,B3,F2,L1,R1,L1,F3,R2,B1,L1,R2,B1,L1,F1,R1,L1,U1,R2,B1,L1,F3,B1,F2,L1,R2,B1,L2,R1,B1,R1,L1,F1,L1,R1,B1,L2,R1,B2,U1,B3,L3,R2,L1,D1,R1,L1,F1,B1,L1,R1,L1,R1,B1,R3,B1,F1,U1,B2,F1,R3,F1,L1,B1,F1,B1,F2,R1,B1,F1,L1,F1,L1,F1,R1,L1,F1,B1,F1,B1,L2,F1,B1,L1,R1,F2,L2,R1,B1,L1,D1,F1,R1,B1,L1,R1,F1,L1,B1,D1,F3,R1,D1,F1,B2,L1,B1,F1,L3,R1,F2,D1,U1,B1,L1,R1,F1,L2,B1,F1,R3,B1,L1,B2,F5,R1,F2,R1,F1,R1,F1,U1,R1,L1,F2,L1,B1,R1,L1,B1,F1,B1,L1,R3,D1,F1,R1,B1,R1,B1,L1,F1,R3,D1,L1,R1,B1,R2,L1,F2,L1,B1,L1,B3,F1,D1,B1,R2,L1,B1,R1,L4,R1,D1,F1,R1,F1,L1,R1,B1,F1,L2,F2,B1,R1,F2,R1,B1,R2,F1,B3,L1,F1,L1,F1,R1,L1,B3,R1,F2,B1,R1,L1,R1,L1,U1,R2,U1,L1,F1,R1,B1,D1,B2,F1,R1,D1,R1,F1,U1,R1,B1,R1,B1,R2,B2,F1,R1,U1,F2,L1,R1,B1,R1,F4,R1,F1,B1,F1,R1,F1,B2,R1
                U10,R1,F1,R1,F2,L1,F1,L1,R3,F1,L1,F1,R1,U1,R1,B1,U1,B1,F1,B1,R1,B1,U1,R1,B1,F1,B2,R1,L1,B1,R1,B1,L1,F1,B2,L1,F1,B1,U2,R1,B1,R1,F3,R1,U1,R1,F3,R1,F1,B2,L1,F1,L1,F1,U1,R1,F1,L1,F4,B1,R2,F1,L1,F1,R1,L1,B1,F1,L1,B1,L1,U1,R3,B1,L1,F1,B3,U1,F2,R2,F1,L1,F1,L1,B1,L1,F1,R1,L2,R2,F1,R1,B1,F1,L1,B1,R1,B2,F1,L1,R2,B1,R1,F1,R1,B1,L1,F1,R1,L1,U1,L1,F1,R1,L1,F1,L2,R3,B1,R3,U1,L1,F1,B2,R1,U1,F1,L1,R3,L1,B2,L2,F1,L1,R1,L1,F1,B1,U1,B1,L2,F2,B1,R1,D1,U1,R1,L1,F1,R1,L1,F1,R1,B1,L1,R1,F1,B2,R1,F1,L1,U1,L1,U1,R1,D1,F1,U1,B1,F4,R2,F1,B1,F1,U2,F1,L2,F1,B2,R1,B1,L2,R1,B1,R1,B2,F2,B1,R1,B1,R1,B1,R2,F3,R4,B1,R1,L1,B1,R1,D1,F1,B1,R1,F1,U1,B1,R1,L1,F1,B1,L1,R1,B1,L1,F1,L1,R2,B1,L2,F1,R1,U1,F2,L1,B1,F1,R2,B1,R1,B2,R2,B1,L1,F1,D1,U1,F1,U1,R1,U1,R2,B1,R1,F1,L1,F1,B1,U1,L2,B1,L1,B1,L1,B1,D1,F1,R1,L1,D1,L1,B1,R2,L1,R1,D1,B1,R1,L1,F1,B2,L1,D2,R1,F3,R2,U1,L1,B3,F1,R1,L1,F2,U1,F1,B1,F1,R1,F1,R1,B1,R1,F2,R1,L2,B1,R1,B1,F1,B2,L1,B1,L2,B1,R1,B1,U1,F2,R3,B2,D1,F2,U1,B1,R1,B1,L1,U1,R1,D1,L2,F2,L2,F1,B1,L1,B1,F2,R1,B1,F1,B1,F1,L1,B1,L1,R1,B1,R1,B2,F1,L1,R2,U1,B1,F1,R2,B1,F2,L1,F3,B1,F2,L1,B1,R1,F1,B1,R1,L2,R1,B1,L1,D1,L1,R1,F1,L3,R1,F2,B1,L1,F1,D1,B1,L1,B1,F1,R2,U1,R1,F3,L1,R1,B1,F1,R1,B2,L1,U1,F1,R1,L3,F1,R1,F1,B1,F1,R2
                U15,B1,R1,B1,L1,F1,L3,U1,F1,L1,F1,R1,L2,U1,F1,B1,U1,F1,R1,L2,F1,L1,U1,F1,L1,B1,R1,F1,U1,L2,B2,L1,R1,L1,U1,L3,R2,F1,B1,L1,B1,R1,B2,F1,B2,L1,R1,L1,F2,B1,D1,B2,L1,F3,B3,F1,L1,F1,B1,R1,B2,F1,R1,U1,L3,F3,L1,B1,F1,B1,R2,B1,F1,R1,F1,B1,R1,F1,R2,B1,R1,L1,F1,R1,F1,L1,B1,R1,D1,B1,F1,B3,L1,R1,F1,R2,B3,U1,B1,R2,L1,R2,L2,R1,L1,F1,B2,U1,B3,D1,R1,F2,L1,F1,L1,R3,U1,R2,L1,U1,L1,R2,B1,L2,U1,F1,R1,F1,B1,L1,R1,L1,F1,U1,F2,R1,L1,F1,R1,U1,B1,R1,F2,R2,B1,R1,U1,F1,R1,F1,B1,F1,R1,B1,L1,B1,L1,F1,L1,R2,B1,R1,B1,L1,F1,L1,F1,B1,F1,B1,L1,R1,F1,B1,R1,F1,L1,U1,B1,R1,B1,L1,R1,B1,F1,L1,F1,R1,B1,L1,U1,R1,L1,U1,L1,F2,D1,R1,U1,F2,U1,F2,L1,U1,F1,R1,U1,B1,F1,B1,R1,F2,B3,L3,R2,F1,R2,F1,L1,R2,L1,R1,B1,L1,B1,R1,F1,B1,L1,D2,L3,R1,L1,F1,B1,F1,B1,D1,F2,L1,F1,U1,F2,B1,F1,B1,F3,U1,B1,L1,U1,F1,R1,B1,R2,L1,B2,R1,B1,F2,L1,B1,R1,F2,B1,R1,F1,B1,L1,B2,R1,L1,D1,B1,F2,R1,L1,B1,R1,B1,F1,R1,B1,F1,B1,F1,R1,B2,F1,B2,L2,B1,F4,B1,F1,R1,F2,U1,F1,R1,B3,R1,D1,F2,B1,F1,B1,R2,F1,L3,B1,R1,F3,B2,F1,R2,F1,L1,D1,L1,B1,L1,B2,F1,R1,L1,F1,R2,U1,D1,R2,L1,F1,R1,B2,F1,B4,L1,B1,F1,R1,F1,D1,L1,R1,D1,L1,F2,R1,F1,L1,B1,F1,L1,F1,R1,F1,B1,F2,R2,L1,B1,L1,R1,D1,L1,F1,B3,L1,F1,R1,B1,L2,R2,L1,R2,B2,R1,F1,B2,F1,R1,L1,D1,B1,L1,R1,L1,R1,F1,L1,F1,L1,F1,R1,B2,D1
                U30,F1,L1,R1,B1,U1,R1,F1,B1,L1,F3,U1,L1,B1,L1,U1,L1,F1,R1,B1,U1,R2,L1,R1,L1,B1,L1,B1,L1,R1,F1,B2,L1,U1,R1,L1,F1,L2,U1,R1,L1,B1,R1,F1,R1,B3,L2,F1,R1,L1,R2,L1,R1,L1,F1,L1,B1,F1,R1,B1,R1,B1,L1,F1,R1,L1,B1,L2,B1,R1,F1,B1,F1,B1,R1,B1,F1,R1,B1,F1,R3,F1,R2,F1,R1,F1,B1,F1,B1,L2,F1,L2,F1,U1,F1,L1,B1,L1,F1,R1,B1,L1,R1,B1,L1,R1,L1,B1,R1,L1,U1,F1,R1,B1,L1,F2,B1,F3,R2,F1,L1,R1,F1,B1,L1,F1,U1,R1,L1,R1,F1,R1,L2,B1,F1,B4,L1,R2,B1,D1,L1,R1,L2,F2,U1,B1,L1,R2,B1,R2,F2,B1,F1,R1,B1,F1,R1,L1,B1,R1,L1,U2,L1,F2,B3,F1,R1,B1,F1,B1,F1,B1,L1,F1,L1,F1,L2,R1,F2,L1,B1,L1,B1,R1,B1,U1,R1,B1,L1,R1,B2,R1,B1,F1,L1,F1,U1,L2,B1,L1,D1,B1,L1,B1,F2,L1,B1,L1,D1,L1,F3,U1,R1,L1,R1,B2,R2,F1,L1,F1,L1,F2,L1,U1,B1,R1,B2,F1,L1,B1,R1,F1,U1,B1,L2,B1,L1,R1,D1,L1,F1,L1,B1,L1,B1,L2,B1,L1,U1,R2,B2,R1,F1,R1,L1,F1,L1,F1,L1,R1,L1,B1,L1,B2,R1,L1,B1,R1,L3,F1,U1,L1,F1,L1,B1,R2,B1,R1,F1,R1,B1,R1,D1,B2,F1,L1,R1,L1,F1,L1,B1,F1,R1,F1,L1,B2,L2,R1,U1,F2,R1,B1,F2,L1,R1,L1,D1,R1,L1,R1,F2,R1,U1,D1,F2,R1,B1,L1,B2,R1,F3,L2,R1,L1,R1,B1,F1,R1,D1,U1,B1,R1,B2,R2,L1,D1,R1,B1,F1,R1,F3,R1,B1,L1,F1,L2,B1,R1,B1,D1,F1,L1,B1,D1,L2,R2,L1,R1,F3,B1,R1,L4,F1,L2,F1,B1,R2,L1,F2,B1,L1,B1,L1,B1,L1,F1,B1,L1,R1,L1,B1,F1,R1,F1,L2,B1,L4,B1,R1,F1,B1,R1,B1,L1,R1,F1,L1,B1,F1,R1,F2,B2,L1,R1,F2,D1,R2,L2,B1,L5
                U40,R1,F1,B1,F1,L2,R1,U1,R1,L2,F1,R1,L1,U1,B4,L1,F1,R1,B1,L1,B1,L1,R1,U1,L1,R1,L2,U1,B1,F1,L4,R1,F1,R1,B1,F1,L1,F2,U1,B2,L1,F1,B1,R1,B1,L1,R2,B1,R2,F1,R3,B1,L2,R1,D1,R1,L1,R1,B2,L1,F1,R1,F2,B3,R1,B1,F1,R2,F2,B2,U1,L1,R1,L1,B1,R1,U1,F3,L1,B1,L1,R1,F1,R2,F1,B1,F1,U1,R1,U1,F1,R2,B1,F1,L1,F1,L1,B2,R1,F1,R1,L2,B1,R1,F4,L1,F2,R1,B1,F3,B2,R1,L2,F1,U1,F2,L2,F2,U2,F1,R1,B1,R1,B1,F2,L1,B1,L3,B1,R1,F3,L2,R1,F1,U1,R1,B1,R3,L1,B1,L1,B1,F2,B1,U1,R1,B1,L1,B1,L1,F2,B1,L1,R1,U1,R2,L1,F2,L1,F1,L1,B1,L4,R1,B2,F1,B1,R1,L1,F3,R1,B1,F3,R2,L1,B2,L1,R1,D1,L1,D1,L1,B1,F1,R1,B1,F1,D1,F1,L1,F2,B1,L1,R1,L1,R1,B1,R1,B3,F1,L3,B1,F1,L1,D1,R1,B1,L1,F2,U1,B1,L1,R1,L1,B2,F1,L2,U1,L3,R1,L1,U1,L1,U1,B1,R1,L3,F1,B2,F1,B1,U1,F1,B2,F1,L1,D1,L2,R1,B1,R1,B1,L1,F1,B1,R1,L1,B1,R1,L1,R1,F1,B1,R1,F1,L1,R1,B2,R1,F1,B1,F1,B4,U1,B1,R1,F1,B1,D1,U2,L1,F1,B1,R1,F1,B2,R1,L1,R1,B1,F1,B1,R1,L2,B2,F1,U1,L1,R1,L1,F2,B1,R2,L1,R1,L1,U1,F1,R1,L1,B1,F1,B2,R3,B1,R1,F1,B1,F1,B1,F2,B1,R1,B1,F1,B1,L1,F1,R2,L1,U1,B1,L2,R1,L1,F2,B1,F1,L1,R1,B1,D1,R1,B1,L1,B4,R3,L1,B1,L1,B1,U1,L5,F2,R1,U1,R1,F1,R2,B3,F1,L1,R1,D1,B1,L1,B1,F1,R1,L1,F3,R1,L1,B1,F3,R1,B2,R1,U1,L1,R1,L1,U1,F1,L2,U1,L3,F1,R1,B1,R2,D1,R1,F1
                U90,R2,L1,F2,B2,R2,L1,F1,B2,R1,L1,F1,L2,B1,F1,R1,U1,R1,L1,R1,L1,F1,L1,F2,B1,F1,R1,U1,B1,L1,B1,R1,L1,R1,L1,R1,F2,D1,U1,L1,R1,L1,R1,F1,L1,F1,L3,R1,L2,F1,R1,F2,B1,F1,R1,F1,B1,L1,F1,L2,R1,U1,L1,F1,L1,U1,L1,F1,U1,B1,R1,L1,U1,B1,L1,B1,F3,B1,R1,F1,R1,L1,R2,B1,U1,B1,F3,R1,B2,L1,R1,L2,B1,F2,L1,F1,B1,F1,B1,R1,U1,B3,L1,B1,L1,R1,L3,F1,B1,U1,L1,D1,F1,L1,F1,B1,L1,F1,L2,D1,L1,B1,R1,L1,F1,L1,U1,L1,B1,F1,L1,U1,R2,L1,R2,L1,R2,L1,R2,L2,F1,L1,B1,R1,U1,F2,R1,L2,R1,L1,F2,L2,R1,F1,R1,B2,L2,R2,L4,F2,B1,F1,U1,F2,R2,L1,R1,B1,L2,F1,R1,F1,R1,B1,L1,B1,F2,B1,R2,L1,B1,F1,R1,B1,R2,F1,R1,F1,B1,L1,F1,L1,B5,L1,F2,R1,F2,L1,F1,B3,L1,F1,B1,R1,F1,U1,F1,R1,U1,F1,R2,L1,F1,R2,F1,B1,R1,B1,L1,F1,L1,F2,R1,L3,B2,F2,R2,D1,F1,B1,R1,F1,D1,R1,B4,F1,L1,F1,B1,L3,F1,B1,F1,U1,F1,L1,B1,D1,L1,F1,L1,B1,R1,B2,R1,B1,L1,B1,L1,D1,B1,R2,B1,R1,F1,L1,B2,R1,F1,B1,R1,L1,B1,R1,B1,R1,U1,L1,R1,F1,R1,L1,U1,L1,R1,D2,B1,R2,L1,B1,R1,L1,R1,B1,L1,R1,L1,F1,L3,D1,F2,R2,B1,L2,R1,F1,B1,F2,R3,L1,B1,R1,F1,L1,R1,F1,B1,L1,B2,F1,D2,L1,R1,F1,U1,D1,L1,B1,F1,L1,F2,R1,F1,L1,B1,R1,B1,D1,F4,L1,B3,U1,F1,R1,B1,L1,D1,L1,F1,R1,L1,F5,R1,B2,L2,F1,R1,B1,F4,D1,L2,B1,L1,R2,B2,U1,B1,L1,F1,D1,R2,F2,L3,D1,B2,F1,B1,L2,F1,R1,D1,F3,B1,R1,B1,L1,R3,F1,L1
                U80,F1,L1,R1,U1,B2,F2,B1,R1,U1,L1,F2,B1,L1,R1,F1,R2,B1,L1,R1,B1,R2,F3,L2,U1,L1,F1,B1,R1,D1,B1,F1,R1,U1,R1,F1,L1,F1,L1,B1,F2,U1,L2,F1,L1,R1,F1,R1,F1,B2,F1,L1,B1,R1,F1,L1,F1,U1,F1,R2,F1,B1,R1,U1,L1,R1,U1,L1,F1,U1,B1,F1,L2,F1,R1,L1,R1,L1,U1,B1,R1,L1,B1,F1,R2,U1,R3,L1,B1,L1,B2,F1,R1,L1,F1,B1,R1,F1,R1,F2,L2,U1,R1,F1,L1,B1,L1,R1,L1,B1,L1,B1,L1,D1,L2,R2,U1,F1,L1,B1,R1,B1,L1,R1,L2,U1,R1,B1,R1,D1,L1,R1,L1,F1,R1,L1,F1,R1,F5,R3,B1,R1,F2,L1,B1,U1,L2,R2,F1,R1,F1,R1,U1,R1,F2,B2,F1,B1,R1,F1,R1,L3,F1,B1,R1,U1,L1,R2,F2,L1,U1,B1,U1,L1,B2,F1,B1,L1,D1,L1,F2,B2,R1,B1,R1,L1,F1,B1,U1,L1,B1,R1,L1,R2,L1,F2,L2,B1,F1,R1,L2,B1,F1,L1,R1,B2,L1,R1,B1,R1,B1,F1,L1,F1,L1,F1,L1,B1,D1,F1,B3,F1,L1,R2,L1,R1,F1,L1,F1,R1,F1,L1,B1,L2,F2,R1,U2,B1,R1,L1,B2,L3,R1,F1,L2,B2,L1,R1,L1,F1,B1,F1,L1,B2,R1,B1,L1,F2,R1,L1,F2,R1,F2,B1,R1,L2,R2,B1,R1,B2,L1,R1,L1,F1,R2,B1,L1,R1,L1,R2,F1,R1,B1,F1,B2,L1,B1,R1,B1,U1,R1,B2,D1,B1,R1,F1,D1,R1,B1,F1,R1,B1,F1,L1,B2,F1,R1,B2,R1,F1,R1,F2,D1,R2,L1,B1,F1,D1,L1,D1,F1,R1,B2,L1,F1,B1,L2,F1,R1,F1,L1,R1,L1,F2,R1,B1,L2,B2,L1,B1,F1,L1,B2,L2,F1,R1,U1,L1,F1,D1,F1,B1,R1,B1,R1,B2,F2,R1,L2,D1,F1,B1,D1,L2,B2,F1,R1,B1,D1,B1,D1,F2,R3,F1,B1,F3,R1,F1,B1,R1,F1,B2,L1,B1,F1,R2,F2,B2,F1,B1,F1,L1,F2,R1,B1,R2,D1,L1,R1,F1,R1,B1,R3,L1,B1
                U35,B1,U1,L2,R2,U1,B2,L1,F1,L2,B1,R1,B1,L1,B1,R1,F2,B1,L1,F3,B1,R1,B1,L2,F1,R2,F1,B2,L1,U1,B1,U1,B1,R2,U2,L1,F1,B1,L1,F1,L1,R1,F1,L1,F2,D1,F1,R3,F1,B1,R2,F1,R3,L1,B1,F3,U1,F1,L1,B1,R1,D1,L1,B1,F1,L1,R1,F1,R1,B2,R1,U1,B1,R1,B1,F1,B1,L1,F1,R1,U1,L1,F1,R2,D1,U1,R1,D1,B1,F1,L2,F1,L1,B1,U1,D1,B1,R1,L2,F1,B1,R1,F1,B1,L1,F1,L1,U1,F3,U2,R1,F1,L2,D1,L1,B1,R1,U1,L1,D1,B1,F1,R1,L1,B2,F1,L1,R1,B1,L1,R1,B2,L1,R2,F1,B2,F1,B2,L1,B1,L2,B1,L1,F1,R1,B1,R1,U1,B1,F1,L1,B1,R1,B1,L1,F1,B1,R1,F1,B1,R1,L2,B1,L1,F1,R1,F1,R2,L1,B1,L1,R1,L3,B1,L1,R2,L1,F1,L1,B1,L1,B1,R5,F1,L1,B3,R1,F1,R1,L1,B1,L2,F1,R1,L2,F1,L1,R1,B1,R1,F1,R1,B1,R1,B1,D1,U1,B1,R1,F2,L1,R1,L3,R1,L2,R1,B1,F1,B1,L1,F1,R1,U1,B1,R1,L1,B2,R1,F1,R3,B1,L1,F1,B1,R2,B1,L2,B1,F1,B1,F1,B2,R1,F1,R1,B1,F2,B5,F1,L2,U1,B1,L1,F1,R1,D1,U1,B1,F1,L1,B1,F1,L1,R4,B1,R1,L2,B1,F1,R1,L1,F1,R1,L3,F1,B3,L1,F1,L1,R1,F1,L1,B1,F1,D1,U1,R1,B1,F2,R2,F1,R1,F1,U1,F1,R3,B1,R1,F1,L3,F1,B1,R1,F1,R1,B1,L1,R1,L1,B1,R2,L2,F1,B1,R4,F1,L1,R1,F1,B1,L1,R1,B1,L1,R1,F1,L1,F1,L1,F1,B2,F1,L2,R1,U1,F1,R1,B2,L1,U1,L2,B2,F4,L1,R1,L1,B1,R2,D1,F1,R2,L3,R1,L1,R1,B1,F2,B1,L1,R1,U1,B1,L2,R1,L2,B1,F1,B1,R2,B1,L1,B2,R1,D1,F1,R1,B1,F1,R1,D1,L1,F1,L1,R1,U1,L1,R1,U1,F1,B1,L1,B2,F1,B1,L2,F3,B1,R1
                U95,L1,U1,B2,U1,B1,U1,R1,B1,U1,F2,L1,R2,F1,B1,L1,F1,R1,F1,R1,F1,R1,U1,F2,L1,F1,R1,B1,F2,R1,L1,B2,R1,L1,F1,B1,R1,L2,B1,R1,F1,L1,R1,B1,L1,B1,F1,L1,U2,L1,F2,B1,F1,B2,F1,B1,F2,B2,F1,B1,F2,R1,L1,U1,D1,R3,F1,L1,R1,U1,F1,R1,B2,L1,B3,R1,L1,B1,F2,L1,R1,U1,L1,R2,F1,B1,R1,F2,U1,D1,F2,R2,F1,B1,R2,F1,L1,B1,R1,U1,L1,R1,L1,B1,R2,B1,L1,F2,R1,U1,B1,R4,F1,B3,D1,F1,L1,R2,B1,F1,B1,R2,F1,B1,U1,L1,F1,R2,B1,F1,B2,F1,B1,F1,B1,F1,L1,U1,L2,F2,L3,R1,L1,B1,F1,B1,L1,B1,F1,L1,U1,B1,L3,B1,L3,B3,L1,F1,R1,U1,F1,R1,B1,L1,B1,L1,F1,R2,U1,B1,R2,F1,L1,F1,R1,F1,B1,L2,B1,F1,D1,F1,B1,L1,R1,L2,B1,D1,L1,R1,L1,R1,B2,L2,B1,F1,L1,B1,U1,B1,F1,B1,R1,D1,B1,U1,B1,U1,B2,U1,R1,L1,F1,R1,F1,R1,F1,L1,F1,R1,L1,B1,R1,F1,L1,R1,B2,R1,L1,F1,L2,B1,F1,L1,B3,F1,R1,L1,R2,F1,B1,R4,F1,L1,R1,B1,D1,L1,R1,F1,R1,F2,L1,F1,L1,F2,B1,F1,R4,F1,R6,F2,R1,F1,B1,D1,R1,F1,L1,B1,L4,R1,F1,R3,F2,R1,B1,L3,R1,B1,R2,L1,R4,B2,F2,B1,L1,B2,F1,R2,B1,R1,F2,B1,R1,F1,R1,L1,R1,B1,L1,F1,R1,L1,F2,R1,F3,R1,D1,B1,L1,R2,L1,F1,L1,R1,B1,F1,L1,B1,L2,F1,B1,L1,B1,F1,R1,F2,R1,B1,R1,B1,R1,L2,F1,U1,R2,B1,F1,B1,F1,R2,B1,L1,R1,L1,F2,L1,R1,F1,R1,B1,R1,B1,L1,B1,L1,B1,R1,B1,U2,R1,F1,B1,F1,D1,B2,F2,R1,L1,R1,F1,B1,F1,R1,F1,B1,F4,B1,F1,R2,B1,L1,U1,L1,B1,L3,R1,F1,R1,B1,L3
                U70,F1,R1,B1,U1,F2,L1,R2,B2,U1,L1,B1,F1,B3,F1,R2,F2,R1,B1,R1,L1,R1,F1,R1,B1,L1,R1,F1,R1,U1,F1,R2,L2,B2,L1,R1,U1,L1,R1,U1,L1,R1,B1,R2,F1,B1,F1,B1,L1,F1,B2,L1,B1,F2,R1,U1,F1,B1,L1,U1,L2,B1,R1,F1,B1,L2,B1,L2,R1,F3,R1,F2,R1,F1,L1,B1,F1,L2,R1,L1,B1,L1,F1,L1,F1,U1,B1,R1,B1,L1,R1,F1,U1,B1,U1,B2,L2,D1,U1,F1,L1,R1,L1,R1,F1,R2,L1,R1,F1,L2,B3,L1,B2,F4,L2,F3,R1,U1,L1,F2,L2,F2,R1,B2,F1,B2,L1,F1,R3,F1,R1,F1,R1,L1,B1,L1,R1,F1,B2,U1,B1,R1,F1,L1,F2,R1,B2,F1,B1,R1,U1,L1,U1,B1,R1,U1,B1,L3,U1,B2,L1,F1,B1,F1,L1,R1,U1,L1,B3,R1,B3,L1,R2,B3,L1,R1,F1,B1,R1,B1,R1,L2,B1,R1,F1,B1,R1,L1,F1,L1,B1,L1,R1,F1,L1,F1,R1,B1,F1,L2,F1,D1,L1,U1,F2,B1,F1,L1,B1,F1,R1,F1,R2,L1,F2,B2,R1,D1,F1,B1,F1,L1,F1,B1,R1,B1,L1,R1,L1,F1,B1,U1,R1,F1,L1,B1,L1,F1,R1,B1,F1,L1,R2,F1,R2,F1,R1,L1,D1,F1,R2,F1,R1,B1,R1,B1,L2,R1,L1,F2,R1,D1,R1,F1,B1,R1,L3,B1,F1,U2,F1,B1,L1,F1,B1,L2,U1,L1,F3,R1,B1,L1,R2,F1,B1,R1,L1,R2,F1,R2,L1,D1,F1,L1,B3,L3,F3,R1,L1,F1,R1,L1,F1,B1,R2,B1,D1,R1,B1,L1,R2,F1,D1,L1,F1,L3,D1,R1,L2,R1,B1,F1,R1,U1,F1,L1,F1,B2,R2,B1,F1,L1,D1,R1,U1,F1,B1,L1,F1,B1,F1,B1,R1,F2,L2,R1,B1,L1,F1,R1,F1,B1,R2,F1,U1,D1,R1,F1,L1,R1,L1,B2,R1,L2,D1,R1,D1,B1,R1,B1,L1,R1,D1,R1,B1,F1,B1,L2,R2,B1,F1,B1,R1,B1,R1,L1,R2,F1,L1,B2,D1,F2,L1,D1,B2,D1,F1,R1,L1,F2,D2,L1
                U50,B1,F1,R1,F1,L4,R2,B1,F1,R1,L1,F2,B1,R1,B1,F2,L3,F3,R1,U1,B1,L1,B1,F1,R1,F1,L1,R1,B1,R1,L1,R2,B1,F1,U1,R1,U1,R1,F1,U1,F1,L1,B2,L1,F1,R1,B1,F2,B1,F1,B1,R1,F2,L1,F1,L1,F1,D1,R1,F1,B1,U1,B1,R1,B2,L1,B3,L2,F1,L1,R1,L1,F1,R1,B5,L1,B3,F1,R1,B1,U2,L1,U1,F1,B1,U1,F1,L1,U1,L1,B2,L1,B1,F1,U1,R1,L1,B1,F1,B1,L1,U1,F1,U1,F1,B1,F1,L2,R1,B1,R1,F1,R1,L1,F2,U1,F1,B1,F1,B1,L2,F1,B1,L1,B2,R1,B2,L2,B1,U1,B1,L3,R1,L2,R1,L1,B1,L2,U1,F1,B1,R4,U1,R1,U2,F1,B1,L1,B1,U1,B1,R3,L1,R1,F1,L1,U1,R1,F1,B1,R2,F1,L1,R1,B1,F1,L2,R1,F1,B2,L2,B1,F1,L3,B1,F1,B1,L1,R1,F1,R1,L1,B2,R1,L2,U1,F1,R1,F1,R1,B1,L1,U2,D1,B1,F1,B1,F1,B3,L1,B2,F2,B2,L2,B1,F1,L2,B2,L1,R1,B1,L1,B1,F1,B1,F1,L1,F2,R1,F2,L1,R1,D1,B1,L3,F2,L2,F1,U1,R1,L2,R2,L4,R1,B2,F2,R2,B2,F1,B1,D1,R2,L1,B1,L1,F2,L1,B1,F2,B1,F1,B1,F1,L1,B2,F1,L3,F3,R1,F1,L1,F1,R1,B1,U1,L1,R2,D1,B1,D1,U1,L1,B1,D1,R2,B1,R1,F1,L1,F1,L1,R2,L2,R1,U1,F2,D1,F1,U1,R2,L3,B1,U1,B1,L1,R1,B3,R1,F1,L1,D2,L3,B1,R1,F1,B1,F2,U1,F1,R1,B1,F2,B1,L4,R2,F1,L1,D1,R1,F1,L1,F1,B1,R1,B1,R1,F1,L1,R3,F1,B1,R1,L3,F1,B1,R1,L2,R1,L1,R1,B2,R2,U1,F1,L1,R1,L1,B1,F1,L1,R1,D1,F1,R3,B1,D1,B3,F1,U1,F1,L2,B1,F3,R1,L1,R1,B1,R1,L1,B1,R1,F1,L1,R1,B1,L1,F1,L2,F1,L1,U1,D1,R3
                U55,L1,B1,L1,U1,R1,L1,R1,U2,B2,L4,B1,R1,B1,F1,B1,L2,B2,L3,F1,L1,F1,B1,L2,F1,R1,L1,F1,B1,F1,B1,U1,L1,B1,L2,R1,L1,B1,R3,L1,B1,F2,B1,U1,F1,L1,B2,F2,B1,L1,B1,F1,B1,R2,B1,U1,B1,F1,U1,L2,B3,L1,F1,B1,R1,F2,R2,L1,B2,R2,B1,L1,B1,R1,L1,B1,L1,R1,B1,F2,R1,B1,L1,F1,B1,F2,L1,B1,U1,F1,R1,L1,R1,B1,L1,B2,R1,L2,F1,L2,R1,F1,U1,B2,R3,F3,R1,B1,L1,U1,B1,L2,D1,F1,R2,F1,L1,U1,R1,L1,U1,F8,R2,B1,R2,D1,R2,U1,L1,D1,L1,B1,F2,R1,L1,F1,B1,R1,L2,B1,F1,R1,D1,F1,U1,F1,B1,L2,B1,L1,B1,F1,B1,F1,B2,R2,U1,F1,B1,L1,F2,L2,F1,R1,B3,R1,F1,R1,B1,F1,R1,F2,B1,R1,B1,L1,F1,B1,L1,B1,R1,U1,D1,R1,L3,R1,B2,F1,B1,U1,F2,L1,F1,L1,R1,D1,L1,R1,F1,D1,R1,U2,L1,R1,F2,R2,L1,B1,R1,B1,R1,L1,R1,U1,R3,B4,L1,F3,L1,D1,R1,L1,B1,F1,R1,L1,F1,L1,F1,B1,L1,U2,L1,F1,R4,B2,F1,L1,F1,L1,F3,U1,F3,R1,U1,B2,L2,R1,B1,L1,B1,R1,B1,F1,R1,B2,L1,F2,R1,D1,F1,U1,R1,L1,B1,F1,L1,R1,F1,R1,B2,L1,R1,L1,F1,L1,B1,R1,B1,F1,L1,R1,B1,F2,R1,L1,B1,F2,B2,R1,F2,U1,L3,F1,B1,L2,B1,L2,D1,F1,L1,U1,L1,R1,B1,L1,F1,L1,R1,F1,R1,F1,B1,F1,U1,F1,B1,R1,L1,B1,F1,U2,L1,B3,R2,B1,L2,F1,L1,F1,L1,R1,L1,R1,L1,F2,B2,R1,F2,R1,B1,R1,U1,L1,R4,L1,F1,B1,F1,D1,R1,B1,F1,R1,F2,L2,D1,R1,F1,L1,B1,R2,U1,B1,L1,F1,L1,D1,B1,L2,F1,B1,F2,R1,B1,F1,B1,L1,F1,R1,B1,R1,D1,B1,L1,R1,B1,R1,B2,R2,B1
                U75,B1,R1,F1,L1,F1,L3,R1,L2,R1,B1,L1,B1,L1,B1,R2,L1,R1,F1,R1,F2,U1,R2,B2,F1,B1,F1,R1,B1,F1,U1,R2,B1,F2,L1,R1,B2,R1,L1,R1,F1,L2,R1,L2,R2,F1,U1,L1,U1,F1,L1,R2,B1,L1,R1,F2,R1,L2,R1,L1,B1,F2,R1,F1,B1,R2,B1,R1,L3,U1,B1,R2,L1,U1,B1,L1,R1,F1,R1,L2,D1,L1,R1,L1,R5,F2,R1,B2,U1,L1,B1,R1,D1,R1,B1,L1,R2,U3,B1,R1,U1,F1,L2,B3,L2,R2,U1,L2,B1,R1,U1,F1,L1,F1,L2,B1,F1,R4,B2,U1,F1,B1,L1,F1,R1,B1,R1,B3,L1,B1,U1,R1,L2,B1,R1,B1,R1,F1,R2,L1,R1,L2,B1,L1,B2,F1,R1,B4,R1,F1,B1,U1,F1,R1,F1,L3,F2,L1,U1,R1,B1,R1,L1,F1,L1,R1,F1,B1,U1,D1,L2,R1,B1,R2,F1,L3,R2,F1,R2,F1,B1,F1,R1,U1,L4,B1,L1,F2,L1,B1,D2,L1,R1,L1,B1,F1,L1,R1,F1,L1,F1,U1,F6,L1,F1,B3,R2,B1,R1,B1,R1,F2,L2,F1,R1,B1,R1,L1,R1,D1,B1,D1,B1,F2,L1,R1,B2,R1,F1,B1,F1,B2,R1,U1,B2,R2,B1,D1,F1,R1,B2,F2,R1,B1,F1,B1,F1,R2,B1,D1,B1,L1,R1,D1,L1,R2,F1,R1,B1,R1,L1,U1,F2,D1,F1,B1,R1,B1,R1,L1,R2,F5,L1,F1,R1,B2,L1,R1,F1,B2,L1,R1,L1,F1,R1,F1,R1,D1,F1,L1,R1,L1,B2,R1,F2,B1,F2,L2,R2,F1,B1,L1,R1,F1,B1,L1,R1,B2,F1,R1,B2,F1,U1,B1,L1,B3,R1,B1,L1,R2,B1,L1,B1,F1,B1,L1,D1,F1,R3,F3,R1,F2,R1,L1,B1,L1,B1,L2,R1,L2,B4,L1,F1,B1,L2,F1,R1,B1,D1,L1,B1,D1,R1,F1,R3,B1,D1,F1,D1,B1,R1,L2,R1,F2,B1,D1,F1,R1,L1,U1,L3,B2,L2,B1,F1,R1,L1,R1,B1,L1
                U60,L2,B2,U1,R1,U1,F1,L1,R1,U1,B2,R4,F1,L1,R3,B2,U2,R2,L1,R1,L3,B1,L1,R1,L1,F1,B1,L1,F1,B3,F1,R2,U1,L1,F1,R1,F1,R2,B1,F1,R2,B1,L1,F1,L1,U1,F1,B1,F1,L1,B1,R1,L1,R2,B2,F1,R1,F1,L1,F1,R1,F1,R1,B1,R1,F1,B2,F2,B1,R1,B1,R1,F2,R1,B1,L1,U1,B1,F1,R1,B2,L1,B1,L1,B1,R1,U1,R2,B1,F1,B1,R2,L4,U1,R1,F1,R2,L1,F2,L1,R2,B1,R3,F1,L1,R1,F2,B1,R1,L1,U1,B1,U1,B1,R1,B2,F1,D1,R1,F1,R2,D1,R1,L1,R1,B1,F1,L1,B1,L1,F1,R1,B2,F1,L3,D1,F1,L1,F1,R2,U1,B1,L2,F1,R1,F1,L1,R2,F1,B1,D1,B2,F4,R1,F1,L1,F3,R2,L1,F1,U1,R1,D1,F1,B1,L1,B1,R1,F1,B1,R1,F1,B2,U1,F1,B1,F1,L1,B3,F1,R1,B1,F3,B1,F1,L1,B1,F1,L2,D1,F2,L1,R1,D1,R3,F1,D1,L1,R1,L4,U1,L1,F1,R1,L5,F1,B1,F1,L1,F1,R1,F3,L1,F1,R1,B1,U1,R1,F1,L1,D1,L1,F1,L1,B1,R1,B2,L1,U1,F1,B2,D1,F1,R3,L1,B2,R1,D1,R1,U1,L1,R1,F1,R2,F1,B1,F1,R1,L1,R1,B1,R1,F1,L1,R3,F1,L1,B1,L1,R1,F1,L2,B1,R1,F1,L1,F1,L1,R1,L1,R1,L4,R1,B1,D1,B1,F1,L1,F1,L1,F1,L1,B1,L1,B4,F1,B1,F2,R3,F2,L1,B1,F1,R2,B4,F1,L3,B1,R2,L1,R2,F1,R3,B1,L1,F1,D1,L1,B1,U2,R1,F1,R1,F2,R1,L3,R1,B1,D1,F1,B1,F1,B1,L1,R3,F2,R1,L4,R1,L2,B1,D1,F1,R1,B1,R1,D2,L1,B2,F1,R1,L1,D1,B1,R2,B1,F2,B1,D1,F1,D1,B1,L1,R1,B2,U1,L1,R2,F1,B2,L2,R2,F1,D1,F2,U1,B1,R1,L1,R1,B1,F1,L1,F1,B1,R2,F1,R1,F2,B1,R1
                U100,F1,B1,L1,R4,L1,R1,B1,L1,F2,L1,F1,L1,F1,B1,F1,L1,B1,U1,R1,B1,L1,R1,B1,F1,R1,L1,B1,L1,B1,L2,R2,L2,B1,F2,R1,B1,F1,R3,F1,R1,B1,R1,U1,F1,R1,F1,B2,L1,R1,F2,L1,U1,F1,R2,F1,L1,R1,B1,R1,F1,B1,U1,B1,F1,R1,F2,L1,B1,R1,L3,R1,B1,U1,L1,U1,R1,B1,L1,F1,B1,R1,F1,R2,L1,F1,R1,B1,F1,B1,F1,R2,F1,L1,B1,R2,F1,R1,L1,R2,B1,U1,B2,R1,F1,B1,R1,F2,R3,L1,F2,B5,F1,R1,B1,U1,F1,B2,R1,B1,L1,F1,L2,B1,L1,B1,L1,B1,L2,B1,L1,U1,D1,R1,L1,F1,B1,F1,R1,L1,F1,B1,F1,U1,D2,L1,F1,B1,R1,F1,R2,L1,F1,B1,R1,L1,R1,L1,F1,R1,F1,R1,F1,L1,B4,R3,B1,R1,B1,F1,R4,F1,U1,B1,R3,F1,B1,R2,F1,R1,L1,B1,R1,F2,B1,L1,R1,F2,R1,L2,R1,L1,R1,L1,B1,F1,B1,L1,U1,L2,F2,B2,L1,R1,F1,R1,L2,B2,F1,D1,B2,F2,R1,B1,L2,B1,U1,B2,F1,R1,L1,F1,U1,L1,F1,L1,F1,L1,D1,L1,B1,R2,F1,L1,F1,L1,R1,F1,L3,R1,F1,U1,F1,R1,L1,F2,R2,B1,U1,F1,B1,D1,R1,B1,D1,R1,L1,B1,L1,R3,L2,B1,F1,D1,L1,F1,B2,F1,R1,B1,F2,R1,F1,L2,R1,B2,F1,L1,F1,R2,D1,F1,R1,L1,B1,L1,R1,B1,R1,B1,F1,B1,R1,F1,B1,R1,B1,R1,L2,F1,R1,L1,B2,R1,B1,F1,B2,L2,B1,R1,F1,R1,F1,R2,B1,L1,R1,F1,B1,F1,B1,R1,B1,R1,D1,B3,R3,L2,R1,L3,B1,U1,R1,B1,R1,F2,L1,F1,B2,L1,U1,B1,R1,F2,L1,F1,B1,L1,R1,D1,B1,F1,R1,B1,R1,B1,R1,F1,L2,F1,B1,L1,F1,L3,R3,F1,B2,L1,R1,D1,F1,R1,B2,F1,L1,F1,B1,R2,L1,R3,F2,U1,B1,R1,D1,B1,F1,L2,U1,R1,F2,D1,R1,B1,L1,R1,F2,R1,D1,B2,L1
                U25,F1,R2,F1,L1,F1,L1,F1,R1,B1,F1,B2,R1,B1,U1,R1,F1,L1,R1,F1,U1,R1,U1,F3,R1,L1,B1,R1,F1,R2,L1,B1,R2,F2,R1,B1,F1,B1,R2,F1,U1,R1,B1,L1,R1,L1,R1,L1,R1,F1,R1,B1,F1,B1,L1,B2,R1,U1,R1,L1,R1,L1,B1,R1,B1,R2,B1,F1,L1,R1,B1,L1,R1,F2,U1,L1,F1,B1,R1,B1,L1,B1,R1,B1,F2,R1,L1,F1,B2,L1,R2,B1,L1,F1,R2,B2,L2,F1,U1,F1,D1,R1,F1,R1,D1,R1,L1,B1,F1,B1,L1,U1,R2,B2,L1,R2,U1,B4,U1,L1,R1,F2,L1,R1,F1,L2,B2,R1,B4,F1,R1,F1,L1,B2,F1,U1,F1,R1,F1,L1,R2,F1,B1,F2,L1,R1,L1,R1,L1,D1,R1,L1,B1,F3,R1,L1,F2,R1,L3,B1,L2,F4,B1,F1,B1,L3,B1,L1,B1,L1,F1,L1,F1,R1,B2,R1,F1,L1,R3,B1,U1,F1,B1,R1,F1,L1,U1,L1,F1,L1,B3,R1,L1,F1,R3,F1,L2,B2,L2,D1,L1,F1,R1,B1,L2,B1,L5,B1,R1,L1,R1,U1,L1,F2,B1,F1,R1,B1,R1,L2,B1,U1,L2,R1,L1,F1,L2,B2,R1,F1,R1,F1,D1,B1,R1,L2,R3,F1,L2,B1,U1,R1,B1,L1,B1,F1,U1,B1,F2,B1,L1,D1,F1,L1,R5,L3,R1,F2,L1,B4,R1,D1,R1,F1,L1,B1,L1,R1,B1,L1,U1,R2,D1,B1,L1,F1,L5,F2,L1,R1,B1,L2,B2,R2,F1,L1,F1,L2,R1,F1,L1,F1,B1,F2,L1,B2,U1,R1,L1,R2,L1,F1,B2,F1,B3,F1,R4,L1,B1,L1,B1,R3,B1,F1,U1,R1,B2,L1,F1,B1,R1,B1,L2,B1,L1,R1,U1,B1,L2,B2,L1,R1,B3,L1,F1,L1,D1,R1,D1,B2,F1,L3,R1,B1,L2,F2,B1,F1,B1,F1,L1,F1,B2,R2,D1,F3,L1,R1,B1,U1,L1,F1,L1,F2,R1,B1,R1,B1,F2,R1,L2,B1,R1,L2,F1,B2,R1,L1,R1,L3
                U20,L2,R1,L1,R2,U2,L1,R1,L1,R1,B1,L2,R1,F2,B1,R1,L1,R1,F1,L2,F1,L1,R1,L1,B1,F2,B1,F1,R1,L1,R1,B1,L1,R1,B2,L1,F1,L1,R1,F1,R1,B2,F1,R1,F1,L1,B2,U1,R2,B1,F3,R1,B1,U1,F1,B1,F1,B1,R1,B2,R1,L1,F2,R2,F2,L1,F1,L1,F2,R1,B1,F1,L1,R1,B1,L2,R2,L1,B1,L1,F2,L1,R1,L1,R1,B1,L1,R3,U1,F1,U1,F1,R1,F2,R1,F1,B1,U1,R1,L1,B2,L1,R2,L2,B1,R1,L1,R1,B1,R1,B1,L2,B1,L1,R1,U1,B1,R1,U1,L1,F1,L1,R1,L1,F1,L2,B1,R1,B1,L1,R1,B1,F1,R1,F1,L1,F1,B1,F1,L1,B1,L1,F1,R1,L1,F2,L1,F3,U1,R1,L1,F1,B1,L2,B1,R1,B1,F1,L1,R1,L1,B1,R1,F1,R1,B2,R1,F1,R1,B1,L2,U1,L1,R2,L1,F2,R1,B2,L1,B2,R1,B1,F1,R1,L2,R1,F1,B2,L2,R1,F1,B2,F1,R1,L1,F2,L3,B1,R1,F1,R1,F1,B1,L1,B4,F1,D1,F2,B1,L1,F1,L1,F1,B1,R1,B1,L1,B1,F2,L1,F1,R1,F1,R1,F2,L2,B1,F1,R1,L1,F1,D1,L1,F3,L1,B2,R1,D1,F2,L1,R1,B1,F2,L1,B1,L1,F1,U1,B2,R1,B2,L1,F1,D1,U1,F4,R2,B2,L1,U1,B1,R1,L2,R1,L3,B4,L1,B2,F2,R2,B1,L1,B1,U2,B1,F2,B1,L4,F1,R2,B1,D1,L3,B1,L1,B3,F1,U1,B1,D1,L2,F2,D1,B1,L1,F2,B2,L1,F1,D1,F1,R1,B1,L1,F1,L2,R1,D1,R1,L1,R1,F1,D2,U1,R2,B1,L1,F1,R2,L1,B2,D1,R4,B1,L1,B3,F1,L1,R1,B1,L1,F1,L1,R1,D1,L1,F1,B1,R1,L1,R1,B1,R1,L1,F2,L1,R1,B1,R1,F1,R1,F1,R1,F1,B1,F1,L1,B2,L1,F1,L1,B1,R3,L2,F1,R1,U1,B1,L2,B1,U1,L1,F1,R1,B1,L3,F3,U1,F1,B2,L1,F1,L1,D2,R1,B1,F1,L3,F1
                U45,L1,R1,F1,U1,B1,L2,R1,B2,F1,L1,F3,B1,R2,F1,B1,U1,R2,F1,B1,U2,B2,U1,B2,R1,L2,F1,L1,F1,B1,R1,L1,U1,B1,R1,U1,B1,D1,L1,B1,L1,F1,R1,L1,R1,L1,B1,R1,B1,R1,L1,B1,R1,B2,L1,R1,F1,B2,R1,F1,R1,F1,R1,B2,R1,B1,F1,R2,B1,U1,B1,L2,B2,R1,F3,L2,F1,L1,U1,R1,F1,B1,L1,B3,R2,F1,U1,F1,R1,B1,F1,B2,R1,B1,F2,R1,L1,F1,L1,R1,F1,L1,R1,B1,U1,B1,L1,R1,B1,L2,B1,L1,R1,L1,F2,L1,B1,L2,B1,F1,L1,U1,F1,U1,B1,L1,B2,F1,R1,L2,F1,D1,R2,U1,F1,L2,B1,R1,L1,R1,U1,R1,L1,F1,B1,F4,R2,L1,B1,L1,F1,B2,L1,B1,R1,U1,F1,R1,F1,L1,B1,F1,R1,B1,U1,F3,R3,F2,B1,R1,B1,R1,B2,R1,F1,L2,R1,B2,F2,R1,B1,F1,L1,U2,B1,R1,L1,F1,R1,L5,B1,F2,L1,R1,F1,L2,B1,F1,B1,D1,B1,F1,B1,L1,B1,R1,L2,B1,R1,B1,F1,B1,F2,R1,F2,B1,L1,F1,B1,R1,D1,L1,R4,L1,F1,L1,F1,R1,L2,B1,F1,R1,L3,R2,B1,U1,L2,F1,D1,B2,D1,L1,F2,B1,R1,F1,B1,F1,R1,B1,R1,D1,B1,F1,R1,L1,F1,L2,B1,L1,R1,B2,R1,F1,B1,L1,R1,B1,F1,R1,F1,L1,F1,L1,R1,L1,R1,L2,B1,R1,B1,F1,B1,F2,B1,U1,B2,L2,D1,L1,B1,F1,B3,U1,B1,R1,L1,F2,B1,U1,B1,U1,F1,U1,F1,R1,L1,R1,B1,F1,B2,F1,B1,L3,F3,L1,U1,F1,L1,F1,R2,F2,R1,B2,F1,R2,B1,F2,L1,R1,B3,F1,D1,L2,B1,F1,R3,L3,F1,B1,F1,L1,F2,B1,F1,L1,B1,U1,L1,B3,R2,L3,R4,B1,F1,B2,R1,B2,L1,F2,L1,B1,F1,L2,F1,L2,R1,L1,B2,L1,D1,B1,D1,F1,L1,R2,L1,F2,L1,R2,F1,L1,R1,L2,B3,F1,B3
                U65,F1,R1,U1,L2,R1,F1,L1,U1,B1,L2,F2,B2,F1,L1,U1,B1,R1,F1,U1,D1,L1,F3,R1,L1,F1,B1,L4,R1,B2,R1,F1,L1,R1,B1,F1,B1,U1,L1,R2,B1,F2,R1,F1,B1,U1,F1,U1,R1,F2,U1,L1,F3,R2,B1,L1,R1,B2,R2,B1,L2,R1,B1,L1,R1,B1,U1,R2,F2,U1,F2,B1,U1,F1,R2,B1,R1,B1,F1,D1,B1,F1,B1,F1,U1,B2,F1,R1,B1,F1,L1,F2,U1,B2,L1,B1,L1,U2,B1,L1,R1,B1,L1,F1,B1,U1,B1,R1,L2,B1,R1,B1,F1,R1,B1,R1,U1,F1,R1,U1,L1,R1,L1,B1,L1,U1,L1,B1,L1,F2,R2,L1,U3,F1,B1,L2,F2,R1,B1,L5,F1,L1,B2,L1,R1,F1,B1,F1,B1,L1,B2,D1,U2,R1,B1,R4,L1,B1,U2,F2,B1,F1,L1,D1,L1,B2,D1,L2,B2,F1,L2,R1,F1,U1,L1,B1,L2,R3,B1,F1,R1,F1,L1,R2,B2,F1,U1,L1,R1,L1,R1,B1,F2,L1,B1,R1,L1,D1,R1,B2,L1,B1,L1,B1,R2,F1,B1,R2,F1,L3,R1,F1,B3,F3,L1,F2,L1,B1,U1,B1,L1,B3,U1,B3,L2,B1,F1,D1,F1,L1,B1,R2,L1,B2,R1,F1,B2,L2,B1,F1,R2,B1,F1,L2,F1,D1,F1,R1,F1,B1,F1,U1,L1,F1,B1,F1,R1,F3,L3,R1,D1,L1,R1,U1,R1,B2,L1,D1,L1,R1,L2,F1,U1,F1,L2,B1,R1,B2,D1,L1,F1,L1,B3,R1,D1,F1,L1,B2,F1,L1,B2,R1,L1,F1,B1,F1,B1,F2,L1,B1,R1,F1,R2,L1,B1,R2,B1,F1,B1,R1,L1,F1,U1,R1,L1,F1,D1,R1,B1,F2,D1,B1,L1,F1,R2,F1,B1,L1,B1,L3,D1,R1,L2,R1,F2,L1,B1,F2,B1,F2,R1,L1,F1,B1,L1,F1,B1,F1,L1,B1,L2,F1,B1,R1,F1,B1,L1,R1,L1,R1,B1,R1,L1,D1,B1,F1,L1,R2,B1,F1,L2,R1,B1,L1,R1,F2,L1,B1,F1,U1,R1,L1,R2,F1,L2,F1,L1,F1,L1,B1,R1,L1,B1,F1,L1
                U105,F1,R1,F1,L1,R1,U1,L2,B2,R1,B1,F1,U1,L1,R1,B6,R1,F4,B1,U1,B1,L1,R1,B1,L1,B2,F1,B1,F1,L3,B2,R1,B1,L2,U1,F1,R1,B2,L1,F1,B1,L1,B1,R1,L1,B2,L1,B1,R2,L1,R1,D1,F1,R1,F1,L1,F1,L1,R1,L1,B1,U1,F1,B1,R1,F2,L1,B1,D1,B1,U1,B1,F1,U1,F1,L1,R1,B1,D1,B1,L2,R1,F1,L1,R2,L2,F1,B1,L2,F1,L2,R2,F1,L1,R1,F1,R1,B3,U1,L1,B1,F1,R1,B4,D1,R1,B1,F5,B2,R2,L1,B1,D1,F1,B1,R1,D1,L1,R2,L1,F1,B1,L2,B1,R1,L3,B1,R1,B1,L1,U1,L1,B1,L1,R2,B1,F1,R3,L1,R1,L1,B1,F2,B1,L1,R1,L1,B1,D1,B1,L1,R1,D1,F1,L3,B1,R1,B1,F2,L1,B2,D1,L1,R1,F1,U1,L1,R2,D1,R1,B1,R2,F1,R2,B1,R1,B1,R3,B1,F1,B1,L1,B2,R1,L1,R1,B1,L3,D1,F2,R1,F1,L2,B1,R1,B1,F1,R1,F1,R1,F1,B1,F1,L1,B1,F1,B3,L2,R2,L1,F1,R2,B2,R1,B1,F1,D1,R1,U1,F2,L1,B1,F2,U1,B1,F3,B1,R1,F1,L1,F1,L1,F1,L1,R1,B2,F2,R1,L1,B1,R1,B2,F1,L1,B1,R2,B1,L1,F1,L1,R1,B1,F1,B1,F1,R1,F1,R1,B1,F1,B2,D1,L1,R1,B1,U1,L4,B1,F1,R1,F1,U1,F1,D1,B1,D1,F2,R1,L3,R1,B3,L1,B1,L1,U1,L1,B2,L1,U1,R1,U1,R1,F2,L1,R1,B1,D1,B1,D1,F1,B1,F1,R1,L1,D1,L1,R1,F1,L1,R1,B1,F1,R1,B1,R2,U1,R1,B1,R2,B1,L1,R1,L1,F1,B1,L1,F2,R1,L1,U1,F2,R1,B2,U1,L1,B2,D1,F3,L1,R1,U1,R2,L3,R1,B1,F1,L1,R5,U1,L4,B1,R1,F1,B1,L1,B2,F2,B1,R1,B1,F1,B1,R1,F2,L1,B1,D1,F1,B1,L1,F1,R1,F1,L3,B1,R1,B1,L1,B1,D1,R1,F1,L2,R2,L1,B1,L2,R1,D1,F1,L2
            """.trimIndent().split("\n").map { it.split(",").map { it[0] to it.substring(1).toInt() } }

            val visited = mutableMapOf<Triple<Int, Int, Int>, Node3d>()
            val leaves = mutableSetOf<Node3d>()

            input.forEachIndexed { index, branch ->
                var current = Triple(0, 0, 0)
                visited[current] = Node3d(current.first, current.second, current.third, 'X')

                branch.forEach { (direction, distance) ->
                    repeat(distance) {
                        current += movements[direction]!!
                        visited[current] = Node3d(current.first, current.second, current.third, 'X')
                    }
                }
                leaves.add(visited[current]!!)
            }

            visited.entries.filter { (it.value.x + it.value.y + it.value.z) % 2 == 0 }.forEach { (key, value) ->
                movements.values.map { key + it }.filter { it in visited }.forEach {
                    value.addNeighbor(visited[it]!!)
                }
            }

            val routeTable = Adjacent.buildRouteTable(leaves.toList())

            println(visited.filter { it.value.y == 0 && it.value.z == 0 }.values.minOf { trunk ->
                leaves.sumOf { leaf ->
                    routeTable[leaf]!![trunk]!!
                }
            })
        }
    }
}

private operator fun Triple<Int, Int, Int>.plus(other: Triple<Int, Int, Int>): Triple<Int, Int, Int> {
    return Triple(first + other.first, second + other.second, third + other.third)
}
